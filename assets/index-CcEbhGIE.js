import{R as Ma,j as t,r as s,P as Et,D as zt,X as kt,M as Na,G as ya,a as Qt,T as ta,Z as wa,b as Ba,c as Da,L as Sa,d as Ea,e as ja,f as Ra,S as ka,A as Pa,g as Ia,h as La}from"./vendor-react-LoMpgU3I.js";import{h as ra}from"./vendor-html2canvas-5Cw11iw4.js";import"./vendor-vHUq6zmN.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))h(c);new MutationObserver(c=>{for(const f of c)if(f.type==="childList")for(const w of f.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&h(w)}).observe(document,{childList:!0,subtree:!0});function o(c){const f={};return c.integrity&&(f.integrity=c.integrity),c.referrerPolicy&&(f.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?f.credentials="include":c.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function h(c){if(c.ep)return;c.ep=!0;const f=o(c);fetch(c.href,f)}})();const Fa=a=>a instanceof Error?a.message+`
`+a.stack:JSON.stringify(a,null,2);class Ta extends Ma.Component{constructor(n){super(n),this.state={hasError:!1,error:null}}static getDerivedStateFromError(n){return{hasError:!0,error:n}}render(){return this.state.hasError?t.jsxs("div",{className:"p-4 border border-red-500 rounded","data-matrix-id":"src/components/ErrorBoundary.tsx:26:8","data-matrix-name":"div","data-component-path":"src/components/ErrorBoundary.tsx","data-component-line":"26","data-component-file":"ErrorBoundary.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22p-4%20border%20border-red-500%20rounded%22%7D",children:[t.jsx("h2",{className:"text-red-500","data-matrix-id":"src/components/ErrorBoundary.tsx:27:10","data-matrix-name":"h2","data-component-path":"src/components/ErrorBoundary.tsx","data-component-line":"27","data-component-file":"ErrorBoundary.tsx","data-component-name":"h2","data-component-content":"%7B%22className%22%3A%22text-red-500%22%7D",children:"Something went wrong."}),t.jsx("pre",{className:"mt-2 text-sm","data-matrix-id":"src/components/ErrorBoundary.tsx:28:10","data-matrix-name":"pre","data-component-path":"src/components/ErrorBoundary.tsx","data-component-line":"28","data-component-file":"ErrorBoundary.tsx","data-component-name":"pre","data-component-content":"%7B%22className%22%3A%22mt-2%20text-sm%22%7D",children:Fa(this.state.error)})]}):this.props.children}}const Wt="meal_map_students",Kt="meal_map_version",Zt="3.0",ca="meal_map_region_colors",ia="meal_map_style_settings",xt=[{name:"天空蓝",value:"sky",hex:"#0EA5E9",bg:"bg-sky-500/75",border:"border-sky-600",text:"text-white"},{name:"翠绿",value:"emerald",hex:"#10B981",bg:"bg-emerald-500/75",border:"border-emerald-600",text:"text-white"},{name:"紫罗兰",value:"purple",hex:"#A855F7",bg:"bg-purple-500/75",border:"border-purple-600",text:"text-white"},{name:"橙色",value:"orange",hex:"#F97316",bg:"bg-orange-500/75",border:"border-orange-600",text:"text-white"},{name:"玫红",value:"rose",hex:"#F43F5E",bg:"bg-rose-500/75",border:"border-rose-600",text:"text-white"},{name:"青色",value:"cyan",hex:"#06B6D4",bg:"bg-cyan-500/75",border:"border-cyan-600",text:"text-white"}],_a=()=>`${Date.now()}_${Math.random().toString(36).substr(2,9)}`,Ot={emptyRegionColor:"#cccccc",canvasBackgroundColor:"#f0ebe6"},Yt=()=>{try{const a=localStorage.getItem(ca);return a?JSON.parse(a):{}}catch(a){return console.error("Failed to load region colors:",a),{}}},da=a=>{try{localStorage.setItem(ca,JSON.stringify(a))}catch(n){console.error("Failed to save region colors:",n)}},$a=(a,n)=>{const o=Yt();o[a]=n,da(o)},Oa=a=>Yt()[a]||null,za=a=>{const n=Yt();delete n[a],da(n)},Wa=()=>Yt(),Ya="#cccccc",ma=()=>{try{const a=localStorage.getItem(ia);if(!a)return Ot;const n=JSON.parse(a),o={...Ot,...n};return o.emptyRegionColor===Ya&&(o.emptyRegionColor=Ot.emptyRegionColor),o}catch(a){return console.error("Failed to load style settings:",a),Ot}},Rt=()=>ma(),sa=a=>{const o={...ma(),...a};try{localStorage.setItem(ia,JSON.stringify(o))}catch(h){console.error("Failed to save style settings:",h)}return o},jt=a=>{const n=Oa(a);if(n){const c=xt.find(f=>f.value===n);return c?c.hex:n}let o=0;for(let c=0;c<a.length;c++)o=(o<<5)-o+a.charCodeAt(c),o=o&o;const h=Math.abs(o)%xt.length;return xt[h].hex},Nt=a=>{let n=xt.find(o=>o.value===a);return!n&&a&&(n=xt.find(o=>o.hex.toLowerCase()===a.toLowerCase())),!n&&a?{name:"自定义",value:a,hex:a,bg:"",border:"",text:"text-white",isCustom:!0}:{...n||xt[0],isCustom:!1}},Ha=a=>a.city?{id:a.id,country:a.country,region_id:a.region_id,region_name:a.region_name,name:a.name,city:a.city,school:a.school,created_at:a.created_at,updated_at:a.updated_at}:{id:a.id,country:a.country,region_id:a.region_id,region_name:a.region_name,name:a.name,city:a.region_name,school:a.school,created_at:a.created_at,updated_at:a.updated_at},Xa=()=>{try{if(localStorage.getItem(Kt)===Zt)return;const n=localStorage.getItem(Wt);if(!n){localStorage.setItem(Kt,Zt);return}const h=JSON.parse(n).map(Ha);localStorage.setItem(Wt,JSON.stringify(h)),localStorage.setItem(Kt,Zt)}catch(a){console.error("Migration failed:",a)}},Ht=()=>{try{Xa();const a=localStorage.getItem(Wt);return a?JSON.parse(a):[]}catch(a){return console.error("Failed to load students from localStorage:",a),[]}},ea=a=>{try{localStorage.setItem(Wt,JSON.stringify(a))}catch(n){console.error("Failed to save students to localStorage:",n)}},qa=a=>{const n=Ht(),o=new Date().toISOString(),h={id:_a(),country:a.country,region_id:a.region_id,region_name:a.region_name,name:a.name,city:a.city,created_at:o,updated_at:o};return n.unshift(h),ea(n),h},Ua=(a,n)=>{const o=Ht(),h=o.findIndex(f=>f.id===a);if(h===-1)return null;const c={...o[h],...n,color:void 0,updated_at:new Date().toISOString()};return o[h]=c,ea(o),c},Ga=a=>{const n=Ht(),o=n.filter(h=>h.id!==a);return o.length===n.length?!1:(ea(o),!0)};function Va({selectedCountry:a,onCountryChange:n,studentCount:o,onExport:h,onColorManager:c}){const[f,w]=s.useState(!1);return t.jsxs("nav",{className:"fixed top-0 left-0 right-0 z-sticky bg-white shadow-sm","data-matrix-id":"src/components/Navigation.tsx:22:4","data-matrix-name":"nav","data-component-path":"src/components/Navigation.tsx","data-component-line":"22","data-component-file":"Navigation.tsx","data-component-name":"nav","data-component-content":"%7B%22className%22%3A%22fixed%20top-0%20left-0%20right-0%20z-sticky%20bg-white%20shadow-sm%22%7D",children:[t.jsxs("div",{className:"max-w-7xl mx-auto px-6 h-16 md:h-18 flex items-center justify-between","data-matrix-id":"src/components/Navigation.tsx:23:6","data-matrix-name":"div","data-component-path":"src/components/Navigation.tsx","data-component-line":"23","data-component-file":"Navigation.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22max-w-7xl%20mx-auto%20px-6%20h-16%20md%3Ah-18%20flex%20items-center%20justify-between%22%7D",children:[t.jsx("div",{className:"flex items-center","data-matrix-id":"src/components/Navigation.tsx:25:8","data-matrix-name":"div","data-component-path":"src/components/Navigation.tsx","data-component-line":"25","data-component-file":"Navigation.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%22%7D",children:t.jsx("h1",{className:"text-h3 font-semibold text-neutral-900","data-matrix-id":"src/components/Navigation.tsx:26:10","data-matrix-name":"h1","data-component-path":"src/components/Navigation.tsx","data-component-line":"26","data-component-file":"Navigation.tsx","data-component-name":"h1","data-component-content":"%7B%22className%22%3A%22text-h3%20font-semibold%20text-neutral-900%22%7D",children:"蹭饭地图"})}),t.jsxs("div",{className:"hidden md:flex items-center gap-1 bg-neutral-100 rounded-md p-1","data-matrix-id":"src/components/Navigation.tsx:30:8","data-matrix-name":"div","data-component-path":"src/components/Navigation.tsx","data-component-line":"30","data-component-file":"Navigation.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22hidden%20md%3Aflex%20items-center%20gap-1%20bg-neutral-100%20rounded-md%20p-1%22%7D",children:[t.jsx("button",{onClick:()=>n("china"),className:`px-6 py-2 rounded-md text-body font-medium transition-all duration-base ${a==="china"?"bg-primary-500 text-white shadow-sm":"text-neutral-700 hover:text-neutral-900"}`,"data-matrix-id":"src/components/Navigation.tsx:31:10","data-matrix-name":"button","data-component-path":"src/components/Navigation.tsx","data-component-line":"31","data-component-file":"Navigation.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22%5BTemplateLiteral%5D%22%7D",children:"中国"}),t.jsx("button",{onClick:()=>n("usa"),className:`px-6 py-2 rounded-md text-body font-medium transition-all duration-base ${a==="usa"?"bg-primary-500 text-white shadow-sm":"text-neutral-700 hover:text-neutral-900"}`,"data-matrix-id":"src/components/Navigation.tsx:41:10","data-matrix-name":"button","data-component-path":"src/components/Navigation.tsx","data-component-line":"41","data-component-file":"Navigation.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22%5BTemplateLiteral%5D%22%7D",children:"美国"})]}),t.jsxs("div",{className:"hidden md:flex items-center gap-4","data-matrix-id":"src/components/Navigation.tsx:54:8","data-matrix-name":"div","data-component-path":"src/components/Navigation.tsx","data-component-line":"54","data-component-file":"Navigation.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22hidden%20md%3Aflex%20items-center%20gap-4%22%7D",children:[t.jsx("div",{className:"bg-neutral-100 px-4 py-2 rounded-full","data-matrix-id":"src/components/Navigation.tsx:56:10","data-matrix-name":"div","data-component-path":"src/components/Navigation.tsx","data-component-line":"56","data-component-file":"Navigation.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22bg-neutral-100%20px-4%20py-2%20rounded-full%22%7D",children:t.jsxs("span",{className:"text-small text-neutral-700","data-matrix-id":"src/components/Navigation.tsx:57:12","data-matrix-name":"span","data-component-path":"src/components/Navigation.tsx","data-component-line":"57","data-component-file":"Navigation.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22text-small%20text-neutral-700%22%7D",children:["已添加 ",t.jsx("span",{className:"font-semibold text-neutral-900","data-matrix-id":"src/components/Navigation.tsx:58:18","data-matrix-name":"span","data-component-path":"src/components/Navigation.tsx","data-component-line":"58","data-component-file":"Navigation.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22font-semibold%20text-neutral-900%22%7D",children:o})," 位同学"]})}),t.jsxs("button",{onClick:c,className:"btn-secondary flex items-center gap-2","data-matrix-id":"src/components/Navigation.tsx:63:10","data-matrix-name":"button","data-component-path":"src/components/Navigation.tsx","data-component-line":"63","data-component-file":"Navigation.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22btn-secondary%20flex%20items-center%20gap-2%22%7D",children:[t.jsx(Et,{className:"w-5 h-5","data-matrix-id":"src/components/Navigation.tsx:64:12","data-matrix-name":"Palette","data-component-path":"src/components/Navigation.tsx","data-component-line":"64","data-component-file":"Navigation.tsx","data-component-name":"Palette","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"}),t.jsx("span",{"data-matrix-id":"src/components/Navigation.tsx:65:12","data-matrix-name":"span","data-component-path":"src/components/Navigation.tsx","data-component-line":"65","data-component-file":"Navigation.tsx","data-component-name":"span",children:"颜色管理"})]}),t.jsxs("button",{onClick:h,className:"btn-primary flex items-center gap-2","data-matrix-id":"src/components/Navigation.tsx:69:10","data-matrix-name":"button","data-component-path":"src/components/Navigation.tsx","data-component-line":"69","data-component-file":"Navigation.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22btn-primary%20flex%20items-center%20gap-2%22%7D",children:[t.jsx(zt,{className:"w-5 h-5","data-matrix-id":"src/components/Navigation.tsx:70:12","data-matrix-name":"Download","data-component-path":"src/components/Navigation.tsx","data-component-line":"70","data-component-file":"Navigation.tsx","data-component-name":"Download","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"}),t.jsx("span",{"data-matrix-id":"src/components/Navigation.tsx:71:12","data-matrix-name":"span","data-component-path":"src/components/Navigation.tsx","data-component-line":"71","data-component-file":"Navigation.tsx","data-component-name":"span",children:"导出当前"})]})]}),t.jsx("button",{onClick:()=>w(!f),className:"md:hidden btn-icon","data-matrix-id":"src/components/Navigation.tsx:76:8","data-matrix-name":"button","data-component-path":"src/components/Navigation.tsx","data-component-line":"76","data-component-file":"Navigation.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22md%3Ahidden%20btn-icon%22%7D",children:f?t.jsx(kt,{className:"w-6 h-6","data-matrix-id":"src/components/Navigation.tsx:80:22","data-matrix-name":"X","data-component-path":"src/components/Navigation.tsx","data-component-line":"80","data-component-file":"Navigation.tsx","data-component-name":"X","data-component-content":"%7B%22className%22%3A%22w-6%20h-6%22%7D"}):t.jsx(Na,{className:"w-6 h-6","data-matrix-id":"src/components/Navigation.tsx:80:50","data-matrix-name":"Menu","data-component-path":"src/components/Navigation.tsx","data-component-line":"80","data-component-file":"Navigation.tsx","data-component-name":"Menu","data-component-content":"%7B%22className%22%3A%22w-6%20h-6%22%7D"})})]}),f&&t.jsxs("div",{className:"md:hidden border-t border-neutral-200 bg-white p-4 space-y-4","data-matrix-id":"src/components/Navigation.tsx:86:8","data-matrix-name":"div","data-component-path":"src/components/Navigation.tsx","data-component-line":"86","data-component-file":"Navigation.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22md%3Ahidden%20border-t%20border-neutral-200%20bg-white%20p-4%20space-y-4%22%7D",children:[t.jsxs("div",{className:"flex gap-2","data-matrix-id":"src/components/Navigation.tsx:88:10","data-matrix-name":"div","data-component-path":"src/components/Navigation.tsx","data-component-line":"88","data-component-file":"Navigation.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20gap-2%22%7D",children:[t.jsx("button",{onClick:()=>{n("china"),w(!1)},className:`flex-1 py-3 rounded-md font-medium transition-all ${a==="china"?"bg-primary-500 text-white":"bg-neutral-100 text-neutral-700"}`,"data-matrix-id":"src/components/Navigation.tsx:89:12","data-matrix-name":"button","data-component-path":"src/components/Navigation.tsx","data-component-line":"89","data-component-file":"Navigation.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22%5BTemplateLiteral%5D%22%7D",children:"中国"}),t.jsx("button",{onClick:()=>{n("usa"),w(!1)},className:`flex-1 py-3 rounded-md font-medium transition-all ${a==="usa"?"bg-primary-500 text-white":"bg-neutral-100 text-neutral-700"}`,"data-matrix-id":"src/components/Navigation.tsx:102:12","data-matrix-name":"button","data-component-path":"src/components/Navigation.tsx","data-component-line":"102","data-component-file":"Navigation.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22%5BTemplateLiteral%5D%22%7D",children:"美国"})]}),t.jsx("div",{className:"bg-neutral-100 px-4 py-3 rounded-md text-center","data-matrix-id":"src/components/Navigation.tsx:118:10","data-matrix-name":"div","data-component-path":"src/components/Navigation.tsx","data-component-line":"118","data-component-file":"Navigation.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22bg-neutral-100%20px-4%20py-3%20rounded-md%20text-center%22%7D",children:t.jsxs("span",{className:"text-small text-neutral-700","data-matrix-id":"src/components/Navigation.tsx:119:12","data-matrix-name":"span","data-component-path":"src/components/Navigation.tsx","data-component-line":"119","data-component-file":"Navigation.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22text-small%20text-neutral-700%22%7D",children:["已添加 ",t.jsx("span",{className:"font-semibold text-neutral-900","data-matrix-id":"src/components/Navigation.tsx:120:18","data-matrix-name":"span","data-component-path":"src/components/Navigation.tsx","data-component-line":"120","data-component-file":"Navigation.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22font-semibold%20text-neutral-900%22%7D",children:o})," 位同学"]})}),t.jsxs("button",{onClick:()=>{c(),w(!1)},className:"w-full btn-secondary flex items-center justify-center gap-2","data-matrix-id":"src/components/Navigation.tsx:125:10","data-matrix-name":"button","data-component-path":"src/components/Navigation.tsx","data-component-line":"125","data-component-file":"Navigation.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22w-full%20btn-secondary%20flex%20items-center%20justify-center%20gap-2%22%7D",children:[t.jsx(Et,{className:"w-5 h-5","data-matrix-id":"src/components/Navigation.tsx:132:12","data-matrix-name":"Palette","data-component-path":"src/components/Navigation.tsx","data-component-line":"132","data-component-file":"Navigation.tsx","data-component-name":"Palette","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"}),t.jsx("span",{"data-matrix-id":"src/components/Navigation.tsx:133:12","data-matrix-name":"span","data-component-path":"src/components/Navigation.tsx","data-component-line":"133","data-component-file":"Navigation.tsx","data-component-name":"span",children:"颜色管理"})]}),t.jsxs("button",{onClick:()=>{h(),w(!1)},className:"w-full btn-primary flex items-center justify-center gap-2","data-matrix-id":"src/components/Navigation.tsx:137:10","data-matrix-name":"button","data-component-path":"src/components/Navigation.tsx","data-component-line":"137","data-component-file":"Navigation.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22w-full%20btn-primary%20flex%20items-center%20justify-center%20gap-2%22%7D",children:[t.jsx(zt,{className:"w-5 h-5","data-matrix-id":"src/components/Navigation.tsx:144:12","data-matrix-name":"Download","data-component-path":"src/components/Navigation.tsx","data-component-line":"144","data-component-file":"Navigation.tsx","data-component-name":"Download","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"}),t.jsx("span",{"data-matrix-id":"src/components/Navigation.tsx:145:12","data-matrix-name":"span","data-component-path":"src/components/Navigation.tsx","data-component-line":"145","data-component-file":"Navigation.tsx","data-component-name":"span",children:"导出当前地图"})]})]})]})}const Ja=(a,n=.85)=>{let o=a.replace("#","");o.length===3&&(o=o.split("").map(A=>A+A).join(""));const h=parseInt(o,16),c=h>>16&255,f=h>>8&255,w=h&255;return`rgba(${c}, ${f}, ${w}, ${n})`},aa=a=>{const n=a.isCustom;return{bgClass:n?"":a.bg,borderClass:n?"":a.border,textClass:n?"text-white":a.text,style:n&&a.hex?{backgroundColor:Ja(a.hex),borderColor:a.hex,color:"#fff"}:void 0}};function Ka({student:a,onEdit:n,onDelete:o,compact:h=!1}){const c=Nt(jt(a.region_id)),f=aa(c),w=f.textClass;return h?t.jsx("div",{className:`${f.bgClass} backdrop-blur-sm rounded-md shadow-md border ${f.borderClass} p-1 
        hover:shadow-lg transition-all duration-base cursor-pointer group`,style:f.style,onClick:()=>n(a),"data-matrix-id":"src/components/StudentCard.tsx:45:6","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"45","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22%5BTemplateLiteral%5D%22%2C%22style%22%3A%22%5BMemberExpression%5D%22%2C%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%7D",children:t.jsxs("div",{className:"flex items-center justify-between gap-1.5","data-matrix-id":"src/components/StudentCard.tsx:51:8","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"51","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20justify-between%20gap-1.5%22%7D",children:[t.jsx("div",{className:"flex-1 min-w-0","data-matrix-id":"src/components/StudentCard.tsx:52:10","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"52","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex-1%20min-w-0%22%7D",children:t.jsxs("p",{className:`text-[11px] font-semibold ${w} truncate leading-tight`,"data-matrix-id":"src/components/StudentCard.tsx:53:12","data-matrix-name":"p","data-component-path":"src/components/StudentCard.tsx","data-component-line":"53","data-component-file":"StudentCard.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22%5BTemplateLiteral%5D%22%7D",children:[a.name," ",t.jsxs("span",{className:"font-normal opacity-80","data-matrix-id":"src/components/StudentCard.tsx:54:29","data-matrix-name":"span","data-component-path":"src/components/StudentCard.tsx","data-component-line":"54","data-component-file":"StudentCard.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22font-normal%20opacity-80%22%7D",children:["| ",a.city]})]})}),t.jsxs("div",{className:"flex gap-0.5","data-matrix-id":"src/components/StudentCard.tsx:57:10","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"57","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20gap-0.5%22%7D",children:[t.jsx("button",{onClick:A=>{A.stopPropagation(),n(a)},className:"p-0.5 hover:bg-white/30 rounded transition-colors",title:"编辑","data-matrix-id":"src/components/StudentCard.tsx:58:12","data-matrix-name":"button","data-component-path":"src/components/StudentCard.tsx","data-component-line":"58","data-component-file":"StudentCard.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22p-0.5%20hover%3Abg-white%2F30%20rounded%20transition-colors%22%2C%22title%22%3A%22%E7%BC%96%E8%BE%91%22%7D",children:t.jsx(Qt,{className:"w-3 h-3 text-white","data-matrix-id":"src/components/StudentCard.tsx:66:14","data-matrix-name":"Edit2","data-component-path":"src/components/StudentCard.tsx","data-component-line":"66","data-component-file":"StudentCard.tsx","data-component-name":"Edit2","data-component-content":"%7B%22className%22%3A%22w-3%20h-3%20text-white%22%7D"})}),t.jsx("button",{onClick:A=>{A.stopPropagation(),window.confirm("确定要删除这位同学吗？")&&o(a.id)},className:"p-0.5 hover:bg-red-100/30 rounded transition-colors",title:"删除","data-matrix-id":"src/components/StudentCard.tsx:68:12","data-matrix-name":"button","data-component-path":"src/components/StudentCard.tsx","data-component-line":"68","data-component-file":"StudentCard.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22p-0.5%20hover%3Abg-red-100%2F30%20rounded%20transition-colors%22%2C%22title%22%3A%22%E5%88%A0%E9%99%A4%22%7D",children:t.jsx(ta,{className:"w-3 h-3 text-white","data-matrix-id":"src/components/StudentCard.tsx:78:14","data-matrix-name":"Trash2","data-component-path":"src/components/StudentCard.tsx","data-component-line":"78","data-component-file":"StudentCard.tsx","data-component-name":"Trash2","data-component-content":"%7B%22className%22%3A%22w-3%20h-3%20text-white%22%7D"})})]})]})}):t.jsx("div",{className:`${f.bgClass} backdrop-blur-sm rounded-md shadow-md border ${f.borderClass} p-2 
      hover:shadow-lg hover:-translate-y-0.5 transition-all duration-base cursor-pointer group`,style:f.style,onClick:()=>n(a),"data-matrix-id":"src/components/StudentCard.tsx:87:4","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"87","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22%5BTemplateLiteral%5D%22%2C%22style%22%3A%22%5BMemberExpression%5D%22%2C%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%7D",children:t.jsxs("div",{className:"flex items-start justify-between gap-2","data-matrix-id":"src/components/StudentCard.tsx:93:6","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"93","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-start%20justify-between%20gap-2%22%7D",children:[t.jsxs("div",{className:"flex-1 min-w-0","data-matrix-id":"src/components/StudentCard.tsx:94:8","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"94","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex-1%20min-w-0%22%7D",children:[t.jsx("h3",{className:`text-sm font-semibold ${w} mb-0.5`,"data-matrix-id":"src/components/StudentCard.tsx:95:10","data-matrix-name":"h3","data-component-path":"src/components/StudentCard.tsx","data-component-line":"95","data-component-file":"StudentCard.tsx","data-component-name":"h3","data-component-content":"%7B%22className%22%3A%22%5BTemplateLiteral%5D%22%7D",children:a.name}),t.jsxs("p",{className:`text-xs ${w} opacity-80`,"data-matrix-id":"src/components/StudentCard.tsx:96:10","data-matrix-name":"p","data-component-path":"src/components/StudentCard.tsx","data-component-line":"96","data-component-file":"StudentCard.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22%5BTemplateLiteral%5D%22%7D",children:[a.city," · ",a.region_name]})]}),t.jsxs("div",{className:"flex gap-1","data-matrix-id":"src/components/StudentCard.tsx:98:8","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"98","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20gap-1%22%7D",children:[t.jsx("button",{onClick:A=>{A.stopPropagation(),n(a)},className:"p-1 hover:bg-white/30 rounded transition-colors",title:"编辑","data-matrix-id":"src/components/StudentCard.tsx:99:10","data-matrix-name":"button","data-component-path":"src/components/StudentCard.tsx","data-component-line":"99","data-component-file":"StudentCard.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22p-1%20hover%3Abg-white%2F30%20rounded%20transition-colors%22%2C%22title%22%3A%22%E7%BC%96%E8%BE%91%22%7D",children:t.jsx(Qt,{className:"w-3 h-3 text-white","data-matrix-id":"src/components/StudentCard.tsx:107:12","data-matrix-name":"Edit2","data-component-path":"src/components/StudentCard.tsx","data-component-line":"107","data-component-file":"StudentCard.tsx","data-component-name":"Edit2","data-component-content":"%7B%22className%22%3A%22w-3%20h-3%20text-white%22%7D"})}),t.jsx("button",{onClick:A=>{A.stopPropagation(),window.confirm("确定要删除这位同学吗？")&&o(a.id)},className:"p-1 hover:bg-red-100/30 rounded transition-colors",title:"删除","data-matrix-id":"src/components/StudentCard.tsx:109:10","data-matrix-name":"button","data-component-path":"src/components/StudentCard.tsx","data-component-line":"109","data-component-file":"StudentCard.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22p-1%20hover%3Abg-red-100%2F30%20rounded%20transition-colors%22%2C%22title%22%3A%22%E5%88%A0%E9%99%A4%22%7D",children:t.jsx(ta,{className:"w-3 h-3 text-white","data-matrix-id":"src/components/StudentCard.tsx:119:12","data-matrix-name":"Trash2","data-component-path":"src/components/StudentCard.tsx","data-component-line":"119","data-component-file":"StudentCard.tsx","data-component-name":"Trash2","data-component-content":"%7B%22className%22%3A%22w-3%20h-3%20text-white%22%7D"})})]})]})})}const Za=s.memo(function({students:n,regionName:o,position:h,onEdit:c,onDelete:f,onDrag:w,cardRef:A}){const[M,k]=s.useState(!1),O=s.useRef({x:0,y:0}),P=s.useRef({x:0,y:0}),U=s.useRef(null),Z=A||U,E=s.useRef(null),p=s.useRef(!1),I=1,z=L=>{const et=L.target;if(et.closest("button")||et.tagName==="BUTTON"||et.closest("a, input, textarea, select"))return;L.preventDefault(),L.stopPropagation(),L.nativeEvent.stopImmediatePropagation();const rt=L.clientX,V=L.clientY;O.current={x:rt,y:V},P.current={x:rt,y:V},p.current=!1,document.body.style.userSelect="none";const yt=Q=>{const pt=Q.clientX,nt=Q.clientY,wt=pt-O.current.x,vt=nt-O.current.y,B=Math.sqrt(wt*wt+vt*vt);if(!p.current){if(B<I)return;p.current=!0,k(!0),document.body.style.cursor="grabbing",P.current={x:O.current.x,y:O.current.y};return}const j=pt-P.current.x,Ct=nt-P.current.y;Math.abs(j)<.1&&Math.abs(Ct)<.1||(E.current&&cancelAnimationFrame(E.current),E.current=requestAnimationFrame(()=>{const J=Z.current,Pt=(J==null?void 0:J.closest("[data-map-container]"))||(J==null?void 0:J.closest(".relative"))||document.querySelector("[data-map-container]")||document.querySelector(".relative");if(Pt){const Bt=Pt.getBoundingClientRect(),bt=j/Bt.width*100,At=Ct/Bt.height*100;w(bt,At)}else{const Bt=window.innerWidth,bt=window.innerHeight,At=j/Bt*100,It=Ct/bt*100;w(At,It)}P.current={x:pt,y:nt}}))},ht=Q=>{if(Q&&(Q.preventDefault(),Q.stopPropagation()),E.current&&(cancelAnimationFrame(E.current),E.current=null),document.removeEventListener("mousemove",yt),document.removeEventListener("mouseup",ht),!p.current){document.body.style.userSelect="",document.body.style.cursor="";return}k(!1),p.current=!1,document.body.style.userSelect="",document.body.style.cursor=""};document.addEventListener("mousemove",yt,{passive:!1}),document.addEventListener("mouseup",ht,{once:!0});const lt=()=>{ht(),document.removeEventListener("mouseleave",lt)};document.addEventListener("mouseleave",lt,{once:!0})};if(n.length===0)return null;const W=Nt(jt(n[0].region_id)),G=aa(W),Y=G.textClass,ut=n.length>1;return t.jsxs("div",{ref:Z,onMouseDown:z,className:`${G.bgClass} backdrop-blur-sm rounded-md shadow-md border ${G.borderClass} px-2.5 py-1.5 
      hover:shadow-lg group min-w-[150px] max-w-[210px] select-none ${M?"cursor-grabbing shadow-2xl scale-105 opacity-90 z-50 transition-none":"cursor-grab transition-all duration-200"}`,style:{...G.style,...M?{pointerEvents:"auto",willChange:"transform",userSelect:"none",WebkitUserSelect:"none"}:{userSelect:"none",WebkitUserSelect:"none"},touchAction:"none"},"data-matrix-id":"src/components/StudentCard.tsx:304:4","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"304","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22onMouseDown%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22%5BTemplateLiteral%5D%22%2C%22style%22%3A%7B%22touchAction%22%3A%22none%22%7D%7D",children:[t.jsxs("div",{className:"flex items-center gap-1 mb-1","data-matrix-id":"src/components/StudentCard.tsx:327:6","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"327","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20gap-1%20mb-1%22%7D",children:[t.jsx(ya,{className:"w-3 h-3 text-white/60 flex-shrink-0","data-matrix-id":"src/components/StudentCard.tsx:328:8","data-matrix-name":"GripVertical","data-component-path":"src/components/StudentCard.tsx","data-component-line":"328","data-component-file":"StudentCard.tsx","data-component-name":"GripVertical","data-component-content":"%7B%22className%22%3A%22w-3%20h-3%20text-white%2F60%20flex-shrink-0%22%7D"}),t.jsxs("div",{className:"flex-1 flex flex-col justify-center leading-tight min-h-[28px]","data-matrix-id":"src/components/StudentCard.tsx:329:8","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"329","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex-1%20flex%20flex-col%20justify-center%20leading-tight%20min-h-%5B28px%5D%22%7D",children:[t.jsx("p",{className:`text-[11px] font-semibold ${Y} whitespace-nowrap mb-0.5`,"data-matrix-id":"src/components/StudentCard.tsx:330:10","data-matrix-name":"p","data-component-path":"src/components/StudentCard.tsx","data-component-line":"330","data-component-file":"StudentCard.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22%5BTemplateLiteral%5D%22%7D",children:o}),ut?t.jsxs("p",{className:`text-[10px] ${Y} opacity-80`,"data-matrix-id":"src/components/StudentCard.tsx:332:12","data-matrix-name":"p","data-component-path":"src/components/StudentCard.tsx","data-component-line":"332","data-component-file":"StudentCard.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22%5BTemplateLiteral%5D%22%7D",children:[n.length," 位同学"]}):t.jsx("p",{className:`text-[10px] ${Y} opacity-80`,"data-matrix-id":"src/components/StudentCard.tsx:334:12","data-matrix-name":"p","data-component-path":"src/components/StudentCard.tsx","data-component-line":"334","data-component-file":"StudentCard.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22%5BTemplateLiteral%5D%22%7D",children:"1 位同学"})]})]}),t.jsx("div",{className:"space-y-1.5 max-h-[200px] overflow-y-auto pr-0.5","data-matrix-id":"src/components/StudentCard.tsx:339:6","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"339","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22space-y-1.5%20max-h-%5B200px%5D%20overflow-y-auto%20pr-0.5%22%7D",children:n.map((L,et)=>{const it=Nt(jt(L.region_id)),rt=aa(it);return t.jsxs("div",{className:`flex items-center justify-between gap-1.5 px-2 py-1.5 ${rt.bgClass} rounded border ${rt.borderClass}`,style:{...rt.style,marginBottom:et<n.length-1?"6px":"0",minHeight:"34px"},"data-matrix-id":"src/components/StudentCard.tsx:344:12","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"344","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22%5BTemplateLiteral%5D%22%2C%22style%22%3A%7B%22marginBottom%22%3A%22%5BConditionalExpression%5D%22%2C%22minHeight%22%3A%2234px%22%7D%7D",children:[t.jsx("div",{className:"flex-1 min-w-0 flex flex-col justify-center leading-tight","data-matrix-id":"src/components/StudentCard.tsx:353:14","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"353","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex-1%20min-w-0%20flex%20flex-col%20justify-center%20leading-tight%22%7D",children:t.jsxs("p",{className:`text-[11px] font-medium ${rt.textClass} leading-tight`,style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"140px",margin:0,padding:0},"data-matrix-id":"src/components/StudentCard.tsx:354:16","data-matrix-name":"p","data-component-path":"src/components/StudentCard.tsx","data-component-line":"354","data-component-file":"StudentCard.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22%5BTemplateLiteral%5D%22%2C%22style%22%3A%7B%22whiteSpace%22%3A%22nowrap%22%2C%22overflow%22%3A%22hidden%22%2C%22textOverflow%22%3A%22ellipsis%22%2C%22maxWidth%22%3A%22140px%22%2C%22margin%22%3A0%2C%22padding%22%3A0%7D%7D",children:[L.name," | ",L.city]})}),t.jsxs("div",{className:"flex gap-0.5 flex-shrink-0","data-matrix-id":"src/components/StudentCard.tsx:368:14","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"368","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20gap-0.5%20flex-shrink-0%22%7D",children:[t.jsx("button",{onClick:V=>{V.stopPropagation(),c(L)},className:"p-0.5 hover:bg-white/30 rounded transition-colors",title:"编辑","data-matrix-id":"src/components/StudentCard.tsx:369:16","data-matrix-name":"button","data-component-path":"src/components/StudentCard.tsx","data-component-line":"369","data-component-file":"StudentCard.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22p-0.5%20hover%3Abg-white%2F30%20rounded%20transition-colors%22%2C%22title%22%3A%22%E7%BC%96%E8%BE%91%22%7D",children:t.jsx(Qt,{className:"w-2.5 h-2.5 text-white","data-matrix-id":"src/components/StudentCard.tsx:377:18","data-matrix-name":"Edit2","data-component-path":"src/components/StudentCard.tsx","data-component-line":"377","data-component-file":"StudentCard.tsx","data-component-name":"Edit2","data-component-content":"%7B%22className%22%3A%22w-2.5%20h-2.5%20text-white%22%7D"})}),t.jsx("button",{onClick:V=>{V.stopPropagation(),window.confirm("确定要删除这位同学吗？")&&f(L.id)},className:"p-0.5 hover:bg-red-100/30 rounded transition-colors",title:"删除","data-matrix-id":"src/components/StudentCard.tsx:379:16","data-matrix-name":"button","data-component-path":"src/components/StudentCard.tsx","data-component-line":"379","data-component-file":"StudentCard.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22p-0.5%20hover%3Abg-red-100%2F30%20rounded%20transition-colors%22%2C%22title%22%3A%22%E5%88%A0%E9%99%A4%22%7D",children:t.jsx(ta,{className:"w-2.5 h-2.5 text-white","data-matrix-id":"src/components/StudentCard.tsx:389:18","data-matrix-name":"Trash2","data-component-path":"src/components/StudentCard.tsx","data-component-line":"389","data-component-file":"StudentCard.tsx","data-component-name":"Trash2","data-component-content":"%7B%22className%22%3A%22w-2.5%20h-2.5%20text-white%22%7D"})})]})]},L.id)})})]})},(a,n)=>a.students.length===n.students.length&&a.students.every((h,c)=>{var f;return h.id===((f=n.students[c])==null?void 0:f.id)})&&a.regionName===n.regionName&&Math.abs(a.position.x-n.position.x)<.01&&Math.abs(a.position.y-n.position.y)<.01&&a.onEdit===n.onEdit&&a.onDelete===n.onDelete&&a.onDrag===n.onDrag);function Qa({count:a,onClick:n}){return t.jsxs("div",{onClick:n,className:`bg-primary-500/75 backdrop-blur-sm rounded-md shadow-lg border border-primary-600 p-3 
      hover:bg-primary-500/85 hover:-translate-y-1 hover:shadow-xl transition-all duration-base cursor-pointer
      flex flex-col items-center justify-center text-white min-w-[80px]`,"data-matrix-id":"src/components/StudentCard.tsx:423:4","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"423","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22bg-primary-500%2F75%20backdrop-blur-sm%20rounded-md%20shadow-lg%20border%20border-primary-600%20p-3%20%5Cn%20%20%20%20%20%20hover%3Abg-primary-500%2F85%20hover%3A-translate-y-1%20hover%3Ashadow-xl%20transition-all%20duration-base%20cursor-pointer%5Cn%20%20%20%20%20%20flex%20flex-col%20items-center%20justify-center%20text-white%20min-w-%5B80px%5D%22%7D",children:[t.jsx("div",{className:"text-2xl font-bold leading-tight","data-matrix-id":"src/components/StudentCard.tsx:429:6","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"429","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22text-2xl%20font-bold%20leading-tight%22%7D",children:a}),t.jsx("div",{className:"text-xs mt-0.5","data-matrix-id":"src/components/StudentCard.tsx:430:6","data-matrix-name":"div","data-component-path":"src/components/StudentCard.tsx","data-component-line":"430","data-component-file":"StudentCard.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22text-xs%20mt-0.5%22%7D",children:"位同学"})]})}const la="meal-map",te=a=>{try{const n=`${la}-${a}-card-positions`,o=localStorage.getItem(n);if(o)return JSON.parse(o)}catch{}return{}},ae=(a,n)=>{try{const o=`${la}-${a}-card-positions`;localStorage.setItem(o,JSON.stringify(n))}catch{}};function ee({country:a,regions:n,students:o,onRegionClick:h,onStudentEdit:c,onStudentDelete:f,onShowList:w,colorChanged:A}){s.useEffect(()=>{if(!n||n.length===0){k(`
        <svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg" class="w-full h-full">
          <text x="400" y="300" text-anchor="middle" font-size="18" fill="#666">
            暂无地区数据
          </text>
        </svg>
      `),P(!1);return}G({}),k(""),P(!0),bt().then(()=>{P(!1)})},[a,n]),s.useEffect(()=>{const e=te(a);ut(e),z(a==="china"?1.15:1)},[a]),s.useEffect(()=>{yt(Rt())},[A]);const[M,k]=s.useState(""),[O,P]=s.useState(!0),[U,Z]=s.useState(!1),[E,p]=s.useState(null),[I,z]=s.useState(a==="china"?1.15:1),[W,G]=s.useState({}),[Y,ut]=s.useState({}),[L,et]=s.useState({width:1200,height:900}),[it,rt]=s.useState(0),[V,yt]=s.useState(Rt()),[ht,lt]=s.useState({}),Q=s.useRef(null),pt=s.useRef(null),nt=s.useRef(null),wt=s.useRef(null),vt=s.useRef(null),B=s.useRef(null),j=s.useCallback(e=>{const r=[e];if(e.startsWith("CN-")&&r.push(e.replace("CN-","")),a==="usa"&&e.startsWith("US-")){const x=e.replace("US-",""),i={AL:"01",AK:"02",AZ:"04",AR:"05",CA:"06",CO:"08",CT:"09",DE:"10",DC:"11",FL:"12",GA:"13",HI:"15",ID:"16",IL:"17",IN:"18",IA:"19",KS:"20",KY:"21",LA:"22",ME:"23",MD:"24",MA:"25",MI:"26",MN:"27",MS:"28",MO:"29",MT:"30",NE:"31",NV:"32",NH:"33",NJ:"34",NM:"35",NY:"36",NC:"37",ND:"38",OH:"39",OK:"40",OR:"41",PA:"42",RI:"44",SC:"45",SD:"46",TN:"47",TX:"48",UT:"49",VT:"50",VA:"51",WA:"53",WV:"54",WI:"55",WY:"56"}[x];i&&r.push(`US-${i}`)}return r},[a]),Ct=e=>{if(!e)return;let r=n.find(x=>x.id===e);if(r)return r;if(a==="china"){if(r=n.find(x=>x.id===`CN-${e}`),r||(r=n.find(x=>`CN-${x.id}`===e),r))return r}else if(a==="usa"){const x={"01":"AL","02":"AK","04":"AZ","05":"AR","06":"CA","08":"CO","09":"CT",10:"DE",11:"DC",12:"FL",13:"GA",15:"HI",16:"ID",17:"IL",18:"IN",19:"IA",20:"KS",21:"KY",22:"LA",23:"ME",24:"MD",25:"MA",26:"MI",27:"MN",28:"MS",29:"MO",30:"MT",31:"NE",32:"NV",33:"NH",34:"NJ",35:"NM",36:"NY",37:"NC",38:"ND",39:"OH",40:"OK",41:"OR",42:"PA",44:"RI",45:"SC",46:"SD",47:"TN",48:"TX",49:"UT",50:"VT",51:"VA",53:"WA",54:"WV",55:"WI",56:"WY"};if(e.startsWith("US-")){const u=e.split("-")[1],i=x[u];if(i&&(r=n.find(l=>l.id===`US-${i}`),r))return r}}if(r=n.find(x=>x.id.endsWith(`-${e}`)),r)return r},J=s.useMemo(()=>o.reduce((e,r)=>(e[r.region_id]||(e[r.region_id]=[]),e[r.region_id].push(r),e),{}),[o]),Pt=s.useCallback(e=>{const{lat:r,lng:x}=e.coordinates;if(a==="china"){const u=(x-73)/62*100,i=(54-r)/36*100;return{x:Math.max(0,Math.min(100,u)),y:Math.max(0,Math.min(100,i))}}else{const u=(x+125)/59*100,i=(50-r)/26*100;return{x:Math.max(0,Math.min(100,u)),y:Math.max(0,Math.min(100,i))}}},[a]),Bt=s.useCallback((e,r,x)=>{const u=V.emptyRegionColor||"#cccccc",i=(l,C)=>{l&&(l.setAttribute("fill",C),l.style.setProperty("fill",C),l.style.setProperty("fill-opacity","1"),l.removeAttribute("fill-opacity"),l.removeAttribute("opacity"),l.style.removeProperty("opacity"))};e.querySelectorAll("path[data-region-id]").forEach(l=>{i(l,u)}),Object.entries(r).forEach(([l])=>{const C=x.find(b=>b.id===l);if(!C)return;let g=jt(l);if(!g.startsWith("#")){const b=xt.find(D=>D.value===g);g=b?b.hex:g}const S=j(l);let d=!1;for(const b of S){const D=e.querySelector(`path[data-region-id="${b}"]`);D&&(i(D,g),d=!0);const F=e.querySelector(`path[id="${b}"]`);F&&(i(F,g),d=!0)}if(!d){const D=Array.from(e.querySelectorAll("path[data-region-name]")).find(F=>{const X=F.getAttribute("data-region-name"),q=F.getAttribute("data-region-id")||"";return X===C.name_en||q===C.id||(q==null?void 0:q.replace("CN-",""))===C.id.replace("CN-","")||(q==null?void 0:q.replace("US-",""))===C.id.replace("US-","")});D&&i(D,g)}})},[V.emptyRegionColor,j]),bt=async()=>{try{const x=`/MealMap/maps/${a==="china"?"china-combined.svg":"usa-combined.svg"}`,u=await fetch(x);if(!u.ok)throw new Error(`Failed to load ${x}`);const i=await u.text(),g=new DOMParser().parseFromString(i,"image/svg+xml").querySelector("svg");if(!g)throw new Error("Invalid SVG structure");const S=g.getAttribute("viewBox");let d=1200,b=900;if(S){const[,,H,_]=S.split(" ").map(Number);d=H,b=_}g.setAttribute("viewBox",`0 0 ${d} ${b}`),g.setAttribute("width","100%"),g.setAttribute("height","100%"),g.getAttribute("preserveAspectRatio")||g.setAttribute("preserveAspectRatio","xMidYMid meet");const D=document.createElement("canvas");D.width=d,D.height=b;const F=D.getContext("2d"),X=(H,_)=>{if(!F||!H)return null;try{const at=new Path2D(H),{minX:T,maxX:K,minY:ot,maxY:$}=_,ft=K-T,m=$-ot,v=(mt,st)=>({x:Math.max(T,Math.min(K,mt)),y:Math.max(ot,Math.min($,st))}),N=(T+K)/2,y=(ot+$)/2,ct=[{x:N,y},{x:N,y:y-m*.06},{x:N,y:y+m*.06},{x:N-ft*.06,y},{x:N+ft*.06,y}],dt=[.3,.45,.6,.75];dt.forEach(mt=>{dt.forEach(st=>{ct.push({x:T+ft*mt,y:ot+m*st})})});for(const mt of ct){const st=v(mt.x,mt.y);if(F.isPointInPath(at,st.x,st.y))return st}}catch{return null}return null},q={};n.forEach(H=>{const _=[H.id,H.id.replace("CN-",""),H.id.replace("US-",""),`CN-${H.id}`,`US-${H.id}`];let at=null;for(const T of _){const K=g.querySelector(`path[data-region-id="${T}"], path[id="${T}"]`);if(K){const ot=K.getAttribute("d");if(ot){const $=[];if((ot.match(/(-?\d+\.?\d*)[\s,]+(-?\d+\.?\d*)/g)||[]).forEach(m=>{const v=m.match(/(-?\d+\.?\d*)[\s,]+(-?\d+\.?\d*)/);if(v){const N=parseFloat(v[1]),y=parseFloat(v[2]);!isNaN(N)&&!isNaN(y)&&N>=0&&N<=d&&y>=0&&y<=b&&$.push({x:N,y})}}),$.length>0){let m=$[0].x,v=$[0].x,N=$[0].y,y=$[0].y;$.forEach(gt=>{m=Math.min(m,gt.x),v=Math.max(v,gt.x),N=Math.min(N,gt.y),y=Math.max(y,gt.y)});const ct=(m+v)/2,dt=(N+y)/2,mt=v-m,st=y-N,ga=Math.min(st*.12,b*.02),Ut=X(ot,{minX:m,maxX:v,minY:N,maxY:y});let Gt=ct,Vt=dt-ga;const va=$.reduce((gt,Jt)=>gt+Jt.x,0)/$.length,Ca=$.reduce((gt,Jt)=>gt+Jt.y,0)/$.length;Gt=Gt*.6+va*.4,Vt=Vt*.6+Ca*.4;let _t=Math.max(m+mt*.12,Math.min(v-mt*.12,Gt)),$t=Math.max(N+st*.12,Math.min(y-st*.12,Vt));Ut&&(_t=Ut.x,$t=Ut.y),_t=Math.max(m,Math.min(v,_t)),$t=Math.max(N,Math.min(y,$t));const ba=mt/d*100,Aa=st/b*100;at={x:_t/d*100,y:$t/b*100,width:ba,height:Aa};break}}}}if(!at){const T=Pt(H);at={x:T.x,y:T.y,width:4,height:4}}q[H.id]=at}),G(q),Bt(g,J,n);const R=new XMLSerializer().serializeToString(g);k(R),et({width:d,height:b}),P(!1)}catch{k(`
        <svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg" class="w-full h-full">
          <text x="400" y="300" text-anchor="middle" font-size="18" fill="#666">
            地图加载失败，请刷新页面重试
          </text>
        </svg>
      `)}};s.useEffect(()=>{o.length>=0&&n.length>0&&setTimeout(()=>{bt()},100)},[o.length,n.length,a]),s.useEffect(()=>{A!==void 0&&A>0&&M&&setTimeout(()=>{bt()},100)},[A,M]),s.useCallback(()=>{rt(e=>e+1)},[]),s.useEffect(()=>{const e=pt.current;if(!e)return;const r=l=>{const g=l.currentTarget.getAttribute("data-region-id");if(g){const S=Ct(g);if(S){const d=J[S.id]||[];d.length>=4?w(S,d):h(S)}}},x=l=>{const C=l.currentTarget;p(C.getAttribute("data-region-id"))},u=()=>{p(null)},i=e.querySelectorAll("path[data-region-id]");return i.forEach(l=>{l.addEventListener("click",r),l.addEventListener("mouseover",x),l.addEventListener("mouseout",u)}),()=>{i.forEach(l=>{l.removeEventListener("click",r),l.removeEventListener("mouseover",x),l.removeEventListener("mouseout",u)})}},[M,n,h,J,w]);const At=s.useRef(null),It=s.useCallback((e,r,x,u,i,l,C,g)=>{const S=(e-x)*(l-g)-(r-u)*(i-C);if(Math.abs(S)<1e-10)return!1;const d=((e-i)*(l-g)-(r-l)*(i-C))/S,b=-((e-x)*(r-l)-(r-u)*(e-i))/S;return d>=0&&d<=1&&b>=0&&b<=1},[]);s.useCallback((e,r,x,u,i,l,C,g)=>{if(e>=i&&e<=C&&r>=l&&r<=g||x>=i&&x<=C&&u>=l&&u<=g)return!0;const S=[{x1:i,y1:l,x2:C,y2:l},{x1:C,y1:l,x2:C,y2:g},{x1:C,y1:g,x2:i,y2:g},{x1:i,y1:g,x2:i,y2:l}];for(const d of S)if(It(e,r,x,u,d.x1,d.y1,d.x2,d.y2))return!0;return!1},[It]);const Xt=s.useRef({}),Lt=s.useRef({}),na=s.useRef(new Map),Mt=s.useRef(Y),Ft=s.useRef(null),qt=s.useRef(!1);s.useEffect(()=>{Lt.current={...Y},Mt.current=Y},[Y]);const tt=s.useCallback(e=>{if(Object.keys(J).length===0||Object.keys(W).length===0){lt({});return}const r=vt.current;if(!r){lt({});return}const x=L.width||1200,u=L.height||900,i=r.getScreenCTM();if(!i)return;const l=i.inverse(),C=b=>{const D=r.createSVGPoint();D.x=b.x,D.y=b.y;const F=D.matrixTransform(l);return{x:F.x,y:F.y}},g=b=>{const D=r.createSVGPoint();D.x=b.x,D.y=b.y;const F=D.matrixTransform(i);return{x:F.x,y:F.y}},S={},d=e||Mt.current;Object.entries(J).forEach(([b,D])=>{if(!D||D.length===0)return;const F=W[b],X=na.current.get(b);if(!F||!X)return;const R=(X.querySelector('[data-inner-card="true"]')||X).getBoundingClientRect();if(R.width===0||R.height===0)return;const H={x:F.x/100*x,y:F.y/100*u};d[b];const _={x:R.left+R.width/2,y:R.top+R.height/2},at=g(H),T=at.x-_.x,K=at.y-_.y;let ot=_.x,$=_.y;if(Math.abs(T)>1e-6||Math.abs(K)>1e-6){const v=[];if(Math.abs(K)>1e-6){let N=(R.top-_.y)/K;if(N>=0&&N<=1){const y=_.x+N*T;y>=R.left&&y<=R.right&&v.push({x:y,y:R.top})}if(N=(R.bottom-_.y)/K,N>=0&&N<=1){const y=_.x+N*T;y>=R.left&&y<=R.right&&v.push({x:y,y:R.bottom})}}if(Math.abs(T)>1e-6){let N=(R.left-_.x)/T;if(N>=0&&N<=1){const y=_.y+N*K;y>=R.top&&y<=R.bottom&&v.push({x:R.left,y})}if(N=(R.right-_.x)/T,N>=0&&N<=1){const y=_.y+N*K;y>=R.top&&y<=R.bottom&&v.push({x:R.right,y})}}if(v.length>0){const N=v.reduce((y,ct)=>{const dt=Math.pow(ct.x-at.x,2)+Math.pow(ct.y-at.y,2);return dt<y.dist?{dist:dt,point:ct}:y},{dist:1/0,point:v[0]}).point;ot=N.x,$=N.y}}const ft=C({x:ot,y:$}),m=H;S[b]={start:ft,end:m}}),lt(S)},[W,J,L]),oa=s.useCallback(()=>{if(Ft.current!==null)return;const e=()=>{if(!qt.current){Ft.current=null;return}tt(Mt.current),Ft.current=requestAnimationFrame(e)};Ft.current=requestAnimationFrame(e)},[tt]);s.useEffect(()=>(window.__mealMapForceLineRecalc=()=>new Promise(e=>{tt(Mt.current),requestAnimationFrame(()=>e())}),()=>{delete window.__mealMapForceLineRecalc}),[tt]),s.useEffect(()=>(window.__mealMapPrepareExport=async()=>{const e=Q.current;if(!e)return()=>{};const r=Array.from(e.querySelectorAll("[data-export-scale-layer]")),x=Array.from(e.querySelectorAll("[data-card-id]")),u=e.getBoundingClientRect();let i=u.left,l=u.top,C=u.right,g=u.bottom;r.forEach(m=>{const v=m.getBoundingClientRect();i=Math.min(i,v.left),l=Math.min(l,v.top),C=Math.max(C,v.right),g=Math.max(g,v.bottom)}),x.forEach(m=>{const v=m.getBoundingClientRect();i=Math.min(i,v.left),l=Math.min(l,v.top),C=Math.max(C,v.right),g=Math.max(g,v.bottom)});const S=Math.ceil(Math.max(16,u.left-i+16)),d=Math.ceil(Math.max(16,u.top-l+16)),b=Math.ceil(Math.max(16,C-u.right+16)),D=Math.ceil(Math.max(16,g-u.bottom+16)),F=u.width+S+b,X=u.height+d+D,q=Math.floor(i)-S,St=Math.floor(l)-d,R=Math.ceil(C)+b,H=Math.ceil(g)+D,_=R-q,at=H-St,T=48,K=q-T,ot=St-T,$=_+T*2,ft=at+T*2;return e.dataset.exportWidthPx=`${F}`,e.dataset.exportHeightPx=`${X}`,e.dataset.exportPaddingLeftPx=`${S}`,e.dataset.exportPaddingRightPx=`${b}`,e.dataset.exportPaddingTopPx=`${d}`,e.dataset.exportPaddingBottomPx=`${D}`,e.dataset.exportBoundsLeftPx=`${K}`,e.dataset.exportBoundsTopPx=`${ot}`,e.dataset.exportBoundsWidthPx=`${$}`,e.dataset.exportBoundsHeightPx=`${ft}`,r.forEach(m=>{const v=m.getBoundingClientRect(),N=m.offsetParent;let y=0,ct=0;if(N){const dt=N.getBoundingClientRect();y=dt.left,ct=dt.top}m.dataset.exportWidthPx=`${v.width}`,m.dataset.exportHeightPx=`${v.height}`,m.dataset.exportLeftPx=`${v.left-y}`,m.dataset.exportTopPx=`${v.top-ct}`,m.dataset.exportTransition=m.style.transition||"",m.style.transition="none"}),x.forEach(m=>{const v=m.getBoundingClientRect();m.dataset.exportLeftPx=`${v.left-u.left}`,m.dataset.exportTopPx=`${v.top-u.top}`,m.dataset.exportWidthPx=`${v.width}`,m.dataset.exportHeightPx=`${v.height}`,m.dataset.exportTransition=m.style.transition||"",m.dataset.exportWillChange=m.style.willChange||"",m.style.transition="none"}),await new Promise(m=>requestAnimationFrame(()=>requestAnimationFrame(m))),window.__mealMapForceLineRecalc&&(await window.__mealMapForceLineRecalc(),await new Promise(m=>requestAnimationFrame(()=>requestAnimationFrame(m)))),()=>{x.forEach(m=>{delete m.dataset.exportLeftPx,delete m.dataset.exportTopPx,delete m.dataset.exportWidthPx,delete m.dataset.exportHeightPx;const v=m.dataset.exportTransition||"";m.style.transition=v,delete m.dataset.exportTransition,delete m.dataset.exportWillChange}),r.forEach(m=>{const v=m.dataset.exportTransition||"";m.style.transition=v,delete m.dataset.exportTransition,delete m.dataset.exportLeftPx,delete m.dataset.exportTopPx}),delete e.dataset.exportWidthPx,delete e.dataset.exportHeightPx,delete e.dataset.exportPaddingLeftPx,delete e.dataset.exportPaddingRightPx,delete e.dataset.exportPaddingTopPx,delete e.dataset.exportPaddingBottomPx,delete e.dataset.exportBoundsLeftPx,delete e.dataset.exportBoundsTopPx,delete e.dataset.exportBoundsWidthPx,delete e.dataset.exportBoundsHeightPx}},()=>{delete window.__mealMapPrepareExport}),[tt]);const Dt=s.useCallback(e=>{B.current&&cancelAnimationFrame(B.current),B.current=requestAnimationFrame(()=>{tt(e)})},[tt]),pa=s.useCallback((e,r,x)=>{const u=Lt.current[e]||{x:0,y:0},i=u.x+r,l=u.y+x,C=W[e];if(C){const g=C.x+i,S=C.y+l;let d=i,b=l;g<0?d=-C.x:g>100&&(d=100-C.x),S<0?b=-C.y:S>100&&(b=100-C.y);const D={x:d,y:b};Xt.current[e]=D,Lt.current[e]=D;const X={...Mt.current,[e]:D};Xt.current[e]=D,Lt.current[e]=D,Mt.current=X,qt.current=!0,ut(X),Dt(X),oa(),At.current&&clearTimeout(At.current),At.current=setTimeout(()=>{ae(a,X)},300)}},[a,W,tt,Dt,oa]);s.useEffect(()=>{if(o.length===0){lt({});return}const e=setTimeout(()=>{tt()},60);return()=>clearTimeout(e)},[o,tt]),s.useEffect(()=>{if(o.length===0)return;const e=()=>tt(),r=()=>requestAnimationFrame(e);r(),r(),r();const x=()=>r();window.addEventListener("resize",x);const u=new ResizeObserver(()=>r());return nt.current&&u.observe(nt.current),()=>{window.removeEventListener("resize",x),u.disconnect()}},[Y,W,I,L,tt,o.length]),s.useEffect(()=>{const e=()=>{qt.current=!1,tt(Mt.current)},r=()=>Dt();return window.addEventListener("mouseup",e),window.addEventListener("mousemove",r),()=>{window.removeEventListener("mouseup",e),window.removeEventListener("mousemove",r)}},[tt,Dt]);const xa=()=>z(e=>Math.min(e+.2,3)),ua=()=>z(e=>Math.max(e-.2,.5)),ha=()=>z(a==="china"?1.15:1),Tt=s.useCallback(async e=>{if(!Q.current)throw new Error("地图容器未准备好");const r=(e==null?void 0:e.format)??"png";let x;try{window.__mealMapPrepareExport?x=await window.__mealMapPrepareExport():window.__mealMapForceLineRecalc&&(await window.__mealMapForceLineRecalc(),await new Promise(d=>requestAnimationFrame(()=>requestAnimationFrame(d))));const i=Q.current.cloneNode(!0);i.style.position="fixed",i.style.top="0",i.style.left="0",i.style.pointerEvents="none",i.style.zIndex="-1",i.style.visibility="visible",i.style.opacity="1",i.style.boxSizing="border-box",i.setAttribute("data-export-temp","true"),(d=>{const b=Number(d.getAttribute("data-export-width-px")||"")||d.getBoundingClientRect().width,D=Number(d.getAttribute("data-export-height-px")||"")||d.getBoundingClientRect().height,F=Number(d.getAttribute("data-export-padding-left-px")||"")||0,X=Number(d.getAttribute("data-export-padding-right-px")||"")||0,q=Number(d.getAttribute("data-export-padding-top-px")||"")||0,St=Number(d.getAttribute("data-export-padding-bottom-px")||"")||0;d.style.width=`${b}px`,d.style.height=`${D}px`,d.style.paddingLeft=`${F}px`,d.style.paddingRight=`${X}px`,d.style.paddingTop=`${q}px`,d.style.paddingBottom=`${St}px`,d.style.overflow="visible",d.style.maxWidth="none",d.style.maxHeight="none",d.querySelectorAll("[data-export-ignore]").forEach(R=>R.remove())})(i),document.body.appendChild(i),await new Promise(d=>requestAnimationFrame(d)),await new Promise(d=>requestAnimationFrame(d));const C=await ra(i,{backgroundColor:V.canvasBackgroundColor||"#f5f5f5",scale:window.devicePixelRatio*2,logging:!1,useCORS:!0,allowTaint:!1,foreignObjectRendering:!0,scrollX:0,scrollY:0}),g=r==="jpeg"?"image/jpeg":"image/png",S=C.toDataURL(g);return document.body.removeChild(i),S}finally{x==null||x(),Dt()}},[Dt,V.canvasBackgroundColor]),fa=s.useCallback(async()=>{if(Q.current){Z(!0);try{const e=await Tt({format:"png"}),r=document.createElement("a"),x=new Date().toISOString().split("T")[0];r.download=`${a==="china"?"中国":"美国"}-蹭饭地图-${x}.png`,r.href=e,r.click()}catch(e){console.error(e),alert("导出失败，请重试")}finally{Z(!1)}}},[a,Tt]);return s.useEffect(()=>(window.__mealMapExport=Tt,()=>{delete window.__mealMapExport}),[Tt]),O?t.jsx("div",{className:"flex items-center justify-center h-full","data-matrix-id":"src/components/InteractiveMap.tsx:1192:6","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1192","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20justify-center%20h-full%22%7D",children:t.jsxs("div",{className:"text-center","data-matrix-id":"src/components/InteractiveMap.tsx:1193:8","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1193","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22text-center%22%7D",children:[t.jsx("div",{className:"inline-block w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin","data-matrix-id":"src/components/InteractiveMap.tsx:1194:10","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1194","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22inline-block%20w-12%20h-12%20border-4%20border-primary-500%20border-t-transparent%20rounded-full%20animate-spin%22%7D"}),t.jsx("p",{className:"mt-4 text-body text-neutral-700","data-matrix-id":"src/components/InteractiveMap.tsx:1195:10","data-matrix-name":"p","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1195","data-component-file":"InteractiveMap.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22mt-4%20text-body%20text-neutral-700%22%7D",children:"加载地图中..."})]})}):t.jsxs("div",{ref:Q,"data-map-container":!0,className:"relative w-full h-full overflow-hidden bg-neutral-50",style:{backgroundColor:V.canvasBackgroundColor},"data-matrix-id":"src/components/InteractiveMap.tsx:1202:4","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1202","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22relative%20w-full%20h-full%20overflow-hidden%20bg-neutral-50%22%2C%22style%22%3A%7B%22backgroundColor%22%3A%22%5BMemberExpression%5D%22%7D%7D",children:[t.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-8",style:{zIndex:10},"data-matrix-id":"src/components/InteractiveMap.tsx:1209:6","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1209","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22absolute%20inset-0%20flex%20items-center%20justify-center%20p-8%22%2C%22style%22%3A%7B%22zIndex%22%3A10%7D%7D",children:t.jsx("div",{ref:pt,"data-export":"true","data-export-scale-layer":!0,className:"w-full h-full transition-transform duration-300",style:{transform:`scale(${I})`},"data-matrix-id":"src/components/InteractiveMap.tsx:1210:8","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1210","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22w-full%20h-full%20transition-transform%20duration-300%22%2C%22style%22%3A%7B%22transform%22%3A%22%5BTemplateLiteral%5D%22%7D%7D",children:M&&t.jsx("svg",{ref:wt,className:"w-full h-full",viewBox:`0 0 ${L.width||1200} ${L.height||900}`,preserveAspectRatio:"xMidYMid meet",dangerouslySetInnerHTML:{__html:`
                  ${M.replace(/<\/?svg[^>]*>/g,"")}
                `},"data-matrix-id":"src/components/InteractiveMap.tsx:1218:12","data-matrix-name":"svg","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1218","data-component-file":"InteractiveMap.tsx","data-component-name":"svg","data-component-content":"%7B%22className%22%3A%22w-full%20h-full%22%2C%22viewBox%22%3A%22%5BTemplateLiteral%5D%22%2C%22preserveAspectRatio%22%3A%22xMidYMid%20meet%22%2C%22dangerouslySetInnerHTML%22%3A%7B%22__html%22%3A%22%5BTemplateLiteral%5D%22%7D%7D"})})}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-8 pointer-events-none",style:{zIndex:20},"data-matrix-id":"src/components/InteractiveMap.tsx:1234:6","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1234","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22absolute%20inset-0%20flex%20items-center%20justify-center%20p-8%20pointer-events-none%22%2C%22style%22%3A%7B%22zIndex%22%3A20%7D%7D",children:t.jsx("div",{ref:nt,className:"w-full h-full transition-transform duration-300","data-export-scale-layer":!0,style:{transform:`scale(${I})`,pointerEvents:"none"},"data-matrix-id":"src/components/InteractiveMap.tsx:1235:8","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1235","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22w-full%20h-full%20transition-transform%20duration-300%22%2C%22style%22%3A%7B%22transform%22%3A%22%5BTemplateLiteral%5D%22%2C%22pointerEvents%22%3A%22none%22%7D%7D",children:t.jsx("svg",{ref:vt,className:"w-full h-full",viewBox:`0 0 ${L.width||1200} ${L.height||900}`,preserveAspectRatio:"xMidYMid meet",style:{pointerEvents:"none"},"data-matrix-id":"src/components/InteractiveMap.tsx:1241:10","data-matrix-name":"svg","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1241","data-component-file":"InteractiveMap.tsx","data-component-name":"svg","data-component-content":"%7B%22className%22%3A%22w-full%20h-full%22%2C%22viewBox%22%3A%22%5BTemplateLiteral%5D%22%2C%22preserveAspectRatio%22%3A%22xMidYMid%20meet%22%2C%22style%22%3A%7B%22pointerEvents%22%3A%22none%22%7D%7D",children:Object.entries(ht).map(([e,r])=>{var i;const x=jt(e),u=((i=xt.find(l=>l.value===x))==null?void 0:i.hex)||x;return t.jsxs("g",{"data-region-line-id":e,style:{pointerEvents:"none"},children:[t.jsx("line",{x1:r.start.x,y1:r.start.y,x2:r.end.x,y2:r.end.y,stroke:u,strokeWidth:3,strokeLinecap:"butt",pointerEvents:"none"}),t.jsx("circle",{cx:r.start.x,cy:r.start.y,r:3.5,fill:u,pointerEvents:"none"}),t.jsx("circle",{cx:r.end.x,cy:r.end.y,r:4,fill:u,pointerEvents:"none"})]},e)})})})}),t.jsx("div",{className:"absolute inset-0 flex items-center justify-center p-8 overflow-visible",style:{zIndex:30,pointerEvents:"none"},"data-matrix-id":"src/components/InteractiveMap.tsx:1273:6","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1273","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22absolute%20inset-0%20flex%20items-center%20justify-center%20p-8%20overflow-visible%22%2C%22style%22%3A%7B%22zIndex%22%3A30%2C%22pointerEvents%22%3A%22none%22%7D%7D",children:t.jsx("div",{className:"w-full h-full pointer-events-none transition-transform duration-300","data-export-scale-layer":!0,style:{transform:`scale(${I})`},"data-matrix-id":"src/components/InteractiveMap.tsx:1274:8","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1274","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22w-full%20h-full%20pointer-events-none%20transition-transform%20duration-300%22%2C%22style%22%3A%7B%22transform%22%3A%22%5BTemplateLiteral%5D%22%7D%7D",children:Object.entries(J).map(([e,r])=>{const x=n.find(d=>d.id===e);if(!x)return null;const u=W[e];if(!u)return null;const i=Xt.current[e],l=Y[e]||{x:0,y:0},C=i||l,g=u.x+C.x,S=u.y+C.y;return t.jsx("div",{ref:d=>na.current.set(e,d),"data-card-id":e,className:"absolute pointer-events-auto transition-all duration-300",style:{left:`${g}%`,top:`${S}%`,transform:"translate(-50%, -50%)",zIndex:31},"data-matrix-id":"src/components/InteractiveMap.tsx:1301:12","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1301","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22absolute%20pointer-events-auto%20transition-all%20duration-300%22%2C%22style%22%3A%7B%22left%22%3A%22%5BTemplateLiteral%5D%22%2C%22top%22%3A%22%5BTemplateLiteral%5D%22%2C%22transform%22%3A%22translate(-50%25%2C%20-50%25)%22%2C%22zIndex%22%3A31%7D%7D",children:r.length>=4?t.jsx("div",{"data-inner-card":"true","data-matrix-id":"src/components/InteractiveMap.tsx:1314:16","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1314","data-component-file":"InteractiveMap.tsx","data-component-name":"div",children:t.jsx(Qa,{count:r.length,onClick:()=>w(x,r),"data-matrix-id":"src/components/InteractiveMap.tsx:1315:18","data-matrix-name":"AggregatedCard","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1315","data-component-file":"InteractiveMap.tsx","data-component-name":"AggregatedCard","data-component-content":"%7B%22count%22%3A%22%5BMemberExpression%5D%22%2C%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%7D"})}):t.jsx("div",{"data-inner-card":"true","data-matrix-id":"src/components/InteractiveMap.tsx:1321:16","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1321","data-component-file":"InteractiveMap.tsx","data-component-name":"div",children:t.jsx(Za,{students:r,regionName:x.name,position:u,onEdit:c,onDelete:f,onDrag:(d,b)=>pa(e,d,b),"data-matrix-id":"src/components/InteractiveMap.tsx:1322:18","data-matrix-name":"DraggableStudentCard","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1322","data-component-file":"InteractiveMap.tsx","data-component-name":"DraggableStudentCard","data-component-content":"%7B%22students%22%3A%22%5BIdentifier%5D%22%2C%22regionName%22%3A%22%5BMemberExpression%5D%22%2C%22position%22%3A%22%5BIdentifier%5D%22%2C%22onEdit%22%3A%22%5BIdentifier%5D%22%2C%22onDelete%22%3A%22%5BIdentifier%5D%22%2C%22onDrag%22%3A%22%5BArrowFunctionExpression%5D%22%7D"})})},e)})})}),t.jsxs("div",{className:"absolute top-4 left-4 bg-white/95 backdrop-blur-sm rounded-lg shadow-lg p-3 max-w-xs pointer-events-auto z-40",style:{maxWidth:"200px"},"data-matrix-id":"src/components/InteractiveMap.tsx:1339:6","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1339","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22absolute%20top-4%20left-4%20bg-white%2F95%20backdrop-blur-sm%20rounded-lg%20shadow-lg%20p-3%20max-w-xs%20pointer-events-auto%20z-40%22%2C%22style%22%3A%7B%22maxWidth%22%3A%22200px%22%7D%7D",children:[t.jsxs("h3",{className:"font-semibold text-neutral-900 mb-2","data-matrix-id":"src/components/InteractiveMap.tsx:1340:8","data-matrix-name":"h3","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1340","data-component-file":"InteractiveMap.tsx","data-component-name":"h3","data-component-content":"%7B%22className%22%3A%22font-semibold%20text-neutral-900%20mb-2%22%7D",children:[a==="china"?"中国":"美国","地图"]}),t.jsxs("div",{className:"space-y-1 text-small text-neutral-700","data-matrix-id":"src/components/InteractiveMap.tsx:1343:8","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1343","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22space-y-1%20text-small%20text-neutral-700%22%7D",children:[t.jsxs("p",{"data-matrix-id":"src/components/InteractiveMap.tsx:1344:10","data-matrix-name":"p","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1344","data-component-file":"InteractiveMap.tsx","data-component-name":"p",children:["已添加同学: ",o.length," 位"]}),t.jsxs("p",{"data-matrix-id":"src/components/InteractiveMap.tsx:1345:10","data-matrix-name":"p","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1345","data-component-file":"InteractiveMap.tsx","data-component-name":"p",children:["覆盖地区: ",Object.keys(J).length," 个"]}),t.jsx("p",{className:"text-caption text-neutral-400 mt-2","data-matrix-id":"src/components/InteractiveMap.tsx:1346:10","data-matrix-name":"p","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1346","data-component-file":"InteractiveMap.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22text-caption%20text-neutral-400%20mt-2%22%7D",children:"点击地图区域添加或查看同学信息"})]})]}),t.jsxs("div",{"data-export-ignore":!0,className:"absolute bottom-6 right-6 flex flex-col gap-2 bg-white/95 backdrop-blur-sm rounded-lg shadow-lg p-2 pointer-events-auto z-40","data-matrix-id":"src/components/InteractiveMap.tsx:1351:6","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1351","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22absolute%20bottom-6%20right-6%20flex%20flex-col%20gap-2%20bg-white%2F95%20backdrop-blur-sm%20rounded-lg%20shadow-lg%20p-2%20pointer-events-auto%20z-40%22%7D",children:[t.jsx("button",{onClick:xa,className:"btn-icon",title:"放大","data-matrix-id":"src/components/InteractiveMap.tsx:1355:8","data-matrix-name":"button","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1355","data-component-file":"InteractiveMap.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22btn-icon%22%2C%22title%22%3A%22%E6%94%BE%E5%A4%A7%22%7D",children:t.jsx(wa,{className:"w-5 h-5","data-matrix-id":"src/components/InteractiveMap.tsx:1356:10","data-matrix-name":"ZoomIn","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1356","data-component-file":"InteractiveMap.tsx","data-component-name":"ZoomIn","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"})}),t.jsx("button",{onClick:ua,className:"btn-icon",title:"缩小","data-matrix-id":"src/components/InteractiveMap.tsx:1358:8","data-matrix-name":"button","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1358","data-component-file":"InteractiveMap.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22btn-icon%22%2C%22title%22%3A%22%E7%BC%A9%E5%B0%8F%22%7D",children:t.jsx(Ba,{className:"w-5 h-5","data-matrix-id":"src/components/InteractiveMap.tsx:1359:10","data-matrix-name":"ZoomOut","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1359","data-component-file":"InteractiveMap.tsx","data-component-name":"ZoomOut","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"})}),t.jsx("button",{onClick:ha,className:"btn-icon",title:"重置","data-matrix-id":"src/components/InteractiveMap.tsx:1361:8","data-matrix-name":"button","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1361","data-component-file":"InteractiveMap.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22btn-icon%22%2C%22title%22%3A%22%E9%87%8D%E7%BD%AE%22%7D",children:t.jsx(Da,{className:"w-5 h-5","data-matrix-id":"src/components/InteractiveMap.tsx:1362:10","data-matrix-name":"Maximize2","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1362","data-component-file":"InteractiveMap.tsx","data-component-name":"Maximize2","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"})}),t.jsx("div",{className:"w-full h-px bg-neutral-200 my-1","data-matrix-id":"src/components/InteractiveMap.tsx:1364:8","data-matrix-name":"div","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1364","data-component-file":"InteractiveMap.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22w-full%20h-px%20bg-neutral-200%20my-1%22%7D"}),t.jsx("button",{onClick:fa,className:"btn-icon",title:U?"正在导出...":"导出图片",disabled:U,"data-matrix-id":"src/components/InteractiveMap.tsx:1365:8","data-matrix-name":"button","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1365","data-component-file":"InteractiveMap.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22btn-icon%22%2C%22title%22%3A%22%5BConditionalExpression%5D%22%2C%22disabled%22%3A%22%5BIdentifier%5D%22%7D",children:U?t.jsx(Sa,{className:"w-5 h-5 animate-spin","data-matrix-id":"src/components/InteractiveMap.tsx:1372:12","data-matrix-name":"Loader2","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1372","data-component-file":"InteractiveMap.tsx","data-component-name":"Loader2","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%20animate-spin%22%7D"}):t.jsx(zt,{className:"w-5 h-5","data-matrix-id":"src/components/InteractiveMap.tsx:1374:10","data-matrix-name":"Download","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1374","data-component-file":"InteractiveMap.tsx","data-component-name":"Download","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"})})]}),t.jsx("style",{"data-matrix-id":"src/components/InteractiveMap.tsx:1380:6","data-matrix-name":"style","data-component-path":"src/components/InteractiveMap.tsx","data-component-line":"1380","data-component-file":"InteractiveMap.tsx","data-component-name":"style",children:`
        svg {
          pointer-events: auto;
        }
        
        .region-path,
        path[data-region-id] {
          /* 不设置默认fill，让动态填充颜色生效 */
          stroke: #E5E5E5;
          stroke-width: 1;
          cursor: pointer;
          pointer-events: auto;
          transition: all 200ms ease-out;
        }
        
        /* 已有填充颜色的区域hover时保持原色，只改变描边 */
        .region-path[fill]:hover,
        path[data-region-id][fill]:hover {
          stroke: #0066FF !important;
          stroke-width: 2.5 !important;
          /* 移除filter，保持原有填充颜色 */
        }
        
        /* 未填充区域hover时显示浅蓝色 */
        .region-path:not([fill]):hover,
        path[data-region-id]:not([fill]):hover {
          fill: #E6F0FF !important;
          stroke: #0066FF !important;
          stroke-width: 2 !important;
        }
        
        ${E?`
          .region-path[data-region-id="${E}"],
          path[data-region-id="${E}"] {
            fill: #E6F0FF !important;
            stroke: #0066FF !important;
            stroke-width: 2 !important;
          }
        `:""}
      `})]})}function ne({isOpen:a,onClose:n,onSave:o,student:h,regionName:c,regionId:f,country:w}){const[A,M]=s.useState({name:"",city:""}),[k,O]=s.useState(!1),[P,U]=s.useState({});s.useEffect(()=>{M(h?{name:h.name,city:h.city||""}:{name:"",city:""}),U({})},[h,a]);const Z=()=>{const p={};return A.name.trim()||(p.name="请输入同学姓名"),A.city.trim()||(p.city="请输入具体城市"),U(p),Object.keys(p).length===0},E=async p=>{if(p.preventDefault(),!!Z()){O(!0);try{await o({...A,region_id:f,region_name:c,country:w}),n()}catch(I){console.error("保存失败:",I),alert("保存失败，请重试")}finally{O(!1)}}};return a?t.jsx("div",{className:"modal-overlay",onClick:n,"data-matrix-id":"src/components/StudentModal.tsx:84:4","data-matrix-name":"div","data-component-path":"src/components/StudentModal.tsx","data-component-line":"84","data-component-file":"StudentModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22modal-overlay%22%2C%22onClick%22%3A%22%5BIdentifier%5D%22%7D",children:t.jsxs("div",{className:"modal-content max-w-md w-full mx-4",onClick:p=>p.stopPropagation(),"data-matrix-id":"src/components/StudentModal.tsx:85:6","data-matrix-name":"div","data-component-path":"src/components/StudentModal.tsx","data-component-line":"85","data-component-file":"StudentModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22modal-content%20max-w-md%20w-full%20mx-4%22%2C%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%7D",children:[t.jsxs("div",{className:"flex items-center justify-between pb-6 border-b border-neutral-200","data-matrix-id":"src/components/StudentModal.tsx:90:8","data-matrix-name":"div","data-component-path":"src/components/StudentModal.tsx","data-component-line":"90","data-component-file":"StudentModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20justify-between%20pb-6%20border-b%20border-neutral-200%22%7D",children:[t.jsxs("div",{"data-matrix-id":"src/components/StudentModal.tsx:91:10","data-matrix-name":"div","data-component-path":"src/components/StudentModal.tsx","data-component-line":"91","data-component-file":"StudentModal.tsx","data-component-name":"div",children:[t.jsx("h2",{className:"text-h2 font-semibold text-neutral-900","data-matrix-id":"src/components/StudentModal.tsx:92:12","data-matrix-name":"h2","data-component-path":"src/components/StudentModal.tsx","data-component-line":"92","data-component-file":"StudentModal.tsx","data-component-name":"h2","data-component-content":"%7B%22className%22%3A%22text-h2%20font-semibold%20text-neutral-900%22%7D",children:h?"编辑同学信息":"添加同学信息"}),t.jsx("p",{className:"text-small text-neutral-700 mt-1","data-matrix-id":"src/components/StudentModal.tsx:95:12","data-matrix-name":"p","data-component-path":"src/components/StudentModal.tsx","data-component-line":"95","data-component-file":"StudentModal.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22text-small%20text-neutral-700%20mt-1%22%7D",children:c})]}),t.jsx("button",{onClick:n,className:"btn-icon","data-matrix-id":"src/components/StudentModal.tsx:97:10","data-matrix-name":"button","data-component-path":"src/components/StudentModal.tsx","data-component-line":"97","data-component-file":"StudentModal.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22btn-icon%22%7D",children:t.jsx(kt,{className:"w-5 h-5","data-matrix-id":"src/components/StudentModal.tsx:98:12","data-matrix-name":"X","data-component-path":"src/components/StudentModal.tsx","data-component-line":"98","data-component-file":"StudentModal.tsx","data-component-name":"X","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"})})]}),t.jsxs("form",{onSubmit:E,className:"mt-6 space-y-6","data-matrix-id":"src/components/StudentModal.tsx:103:8","data-matrix-name":"form","data-component-path":"src/components/StudentModal.tsx","data-component-line":"103","data-component-file":"StudentModal.tsx","data-component-name":"form","data-component-content":"%7B%22onSubmit%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22mt-6%20space-y-6%22%7D",children:[t.jsxs("div",{"data-matrix-id":"src/components/StudentModal.tsx:105:10","data-matrix-name":"div","data-component-path":"src/components/StudentModal.tsx","data-component-line":"105","data-component-file":"StudentModal.tsx","data-component-name":"div",children:[t.jsxs("label",{htmlFor:"name",className:"block text-small font-medium text-neutral-700 mb-2","data-matrix-id":"src/components/StudentModal.tsx:106:12","data-matrix-name":"label","data-component-path":"src/components/StudentModal.tsx","data-component-line":"106","data-component-file":"StudentModal.tsx","data-component-name":"label","data-component-content":"%7B%22htmlFor%22%3A%22name%22%2C%22className%22%3A%22block%20text-small%20font-medium%20text-neutral-700%20mb-2%22%7D",children:["姓名 ",t.jsx("span",{className:"text-error","data-matrix-id":"src/components/StudentModal.tsx:107:17","data-matrix-name":"span","data-component-path":"src/components/StudentModal.tsx","data-component-line":"107","data-component-file":"StudentModal.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22text-error%22%7D",children:"*"})]}),t.jsx("input",{id:"name",type:"text",className:`input ${P.name?"border-error":""}`,placeholder:"请输入同学姓名",value:A.name,onChange:p=>M({...A,name:p.target.value}),"data-matrix-id":"src/components/StudentModal.tsx:109:12","data-matrix-name":"input","data-component-path":"src/components/StudentModal.tsx","data-component-line":"109","data-component-file":"StudentModal.tsx","data-component-name":"input","data-component-content":"%7B%22id%22%3A%22name%22%2C%22type%22%3A%22text%22%2C%22className%22%3A%22%5BTemplateLiteral%5D%22%2C%22placeholder%22%3A%22%E8%AF%B7%E8%BE%93%E5%85%A5%E5%90%8C%E5%AD%A6%E5%A7%93%E5%90%8D%22%2C%22value%22%3A%22%5BMemberExpression%5D%22%2C%22onChange%22%3A%22%5BArrowFunctionExpression%5D%22%7D"}),P.name&&t.jsx("p",{className:"text-caption text-error mt-1","data-matrix-id":"src/components/StudentModal.tsx:118:14","data-matrix-name":"p","data-component-path":"src/components/StudentModal.tsx","data-component-line":"118","data-component-file":"StudentModal.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22text-caption%20text-error%20mt-1%22%7D",children:P.name})]}),t.jsxs("div",{"data-matrix-id":"src/components/StudentModal.tsx:123:10","data-matrix-name":"div","data-component-path":"src/components/StudentModal.tsx","data-component-line":"123","data-component-file":"StudentModal.tsx","data-component-name":"div",children:[t.jsxs("label",{htmlFor:"city",className:"block text-small font-medium text-neutral-700 mb-2","data-matrix-id":"src/components/StudentModal.tsx:124:12","data-matrix-name":"label","data-component-path":"src/components/StudentModal.tsx","data-component-line":"124","data-component-file":"StudentModal.tsx","data-component-name":"label","data-component-content":"%7B%22htmlFor%22%3A%22city%22%2C%22className%22%3A%22block%20text-small%20font-medium%20text-neutral-700%20mb-2%22%7D",children:["具体城市 ",t.jsx("span",{className:"text-error","data-matrix-id":"src/components/StudentModal.tsx:125:19","data-matrix-name":"span","data-component-path":"src/components/StudentModal.tsx","data-component-line":"125","data-component-file":"StudentModal.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22text-error%22%7D",children:"*"})]}),t.jsx("input",{id:"city",type:"text",className:`input ${P.city?"border-error":""}`,placeholder:"请输入具体城市名称",value:A.city,onChange:p=>M({...A,city:p.target.value}),"data-matrix-id":"src/components/StudentModal.tsx:127:12","data-matrix-name":"input","data-component-path":"src/components/StudentModal.tsx","data-component-line":"127","data-component-file":"StudentModal.tsx","data-component-name":"input","data-component-content":"%7B%22id%22%3A%22city%22%2C%22type%22%3A%22text%22%2C%22className%22%3A%22%5BTemplateLiteral%5D%22%2C%22placeholder%22%3A%22%E8%AF%B7%E8%BE%93%E5%85%A5%E5%85%B7%E4%BD%93%E5%9F%8E%E5%B8%82%E5%90%8D%E7%A7%B0%22%2C%22value%22%3A%22%5BMemberExpression%5D%22%2C%22onChange%22%3A%22%5BArrowFunctionExpression%5D%22%7D"}),P.city&&t.jsx("p",{className:"text-caption text-error mt-1","data-matrix-id":"src/components/StudentModal.tsx:136:14","data-matrix-name":"p","data-component-path":"src/components/StudentModal.tsx","data-component-line":"136","data-component-file":"StudentModal.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22text-caption%20text-error%20mt-1%22%7D",children:P.city})]}),t.jsx("div",{className:"text-caption text-neutral-500 bg-neutral-50 p-3 rounded","data-matrix-id":"src/components/StudentModal.tsx:141:10","data-matrix-name":"div","data-component-path":"src/components/StudentModal.tsx","data-component-line":"141","data-component-file":"StudentModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22text-caption%20text-neutral-500%20bg-neutral-50%20p-3%20rounded%22%7D",children:"提示：同一省/州的所有同学将使用相同的卡片颜色"}),t.jsxs("div",{className:"flex gap-4 pt-6 border-t border-neutral-200","data-matrix-id":"src/components/StudentModal.tsx:146:10","data-matrix-name":"div","data-component-path":"src/components/StudentModal.tsx","data-component-line":"146","data-component-file":"StudentModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20gap-4%20pt-6%20border-t%20border-neutral-200%22%7D",children:[t.jsx("button",{type:"button",onClick:n,className:"flex-1 btn-secondary",disabled:k,"data-matrix-id":"src/components/StudentModal.tsx:147:12","data-matrix-name":"button","data-component-path":"src/components/StudentModal.tsx","data-component-line":"147","data-component-file":"StudentModal.tsx","data-component-name":"button","data-component-content":"%7B%22type%22%3A%22button%22%2C%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22flex-1%20btn-secondary%22%2C%22disabled%22%3A%22%5BIdentifier%5D%22%7D",children:"取消"}),t.jsx("button",{type:"submit",className:"flex-1 btn-primary",disabled:k,"data-matrix-id":"src/components/StudentModal.tsx:155:12","data-matrix-name":"button","data-component-path":"src/components/StudentModal.tsx","data-component-line":"155","data-component-file":"StudentModal.tsx","data-component-name":"button","data-component-content":"%7B%22type%22%3A%22submit%22%2C%22className%22%3A%22flex-1%20btn-primary%22%2C%22disabled%22%3A%22%5BIdentifier%5D%22%7D",children:k?"保存中...":"保存"})]})]})]})}):null}function oe({isOpen:a,onClose:n,students:o,regionName:h,onEdit:c,onDelete:f,onAddNew:w}){return a?t.jsx("div",{className:"modal-overlay",onClick:n,"data-matrix-id":"src/components/StudentListModal.tsx:27:4","data-matrix-name":"div","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"27","data-component-file":"StudentListModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22modal-overlay%22%2C%22onClick%22%3A%22%5BIdentifier%5D%22%7D",children:t.jsxs("div",{className:"modal-content max-w-2xl w-full mx-4 max-h-[80vh] flex flex-col",onClick:A=>A.stopPropagation(),"data-matrix-id":"src/components/StudentListModal.tsx:28:6","data-matrix-name":"div","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"28","data-component-file":"StudentListModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22modal-content%20max-w-2xl%20w-full%20mx-4%20max-h-%5B80vh%5D%20flex%20flex-col%22%2C%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%7D",children:[t.jsxs("div",{className:"flex items-center justify-between pb-6 border-b border-neutral-200","data-matrix-id":"src/components/StudentListModal.tsx:33:8","data-matrix-name":"div","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"33","data-component-file":"StudentListModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20justify-between%20pb-6%20border-b%20border-neutral-200%22%7D",children:[t.jsxs("div",{"data-matrix-id":"src/components/StudentListModal.tsx:34:10","data-matrix-name":"div","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"34","data-component-file":"StudentListModal.tsx","data-component-name":"div",children:[t.jsx("h2",{className:"text-h2 font-semibold text-neutral-900","data-matrix-id":"src/components/StudentListModal.tsx:35:12","data-matrix-name":"h2","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"35","data-component-file":"StudentListModal.tsx","data-component-name":"h2","data-component-content":"%7B%22className%22%3A%22text-h2%20font-semibold%20text-neutral-900%22%7D",children:h}),t.jsxs("p",{className:"text-small text-neutral-700 mt-1","data-matrix-id":"src/components/StudentListModal.tsx:36:12","data-matrix-name":"p","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"36","data-component-file":"StudentListModal.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22text-small%20text-neutral-700%20mt-1%22%7D",children:["共 ",o.length," 位同学"]})]}),t.jsx("button",{onClick:n,className:"btn-icon","data-matrix-id":"src/components/StudentListModal.tsx:38:10","data-matrix-name":"button","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"38","data-component-file":"StudentListModal.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22btn-icon%22%7D",children:t.jsx(kt,{className:"w-5 h-5","data-matrix-id":"src/components/StudentListModal.tsx:39:12","data-matrix-name":"X","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"39","data-component-file":"StudentListModal.tsx","data-component-name":"X","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto mt-6 space-y-3 pr-2","data-matrix-id":"src/components/StudentListModal.tsx:44:8","data-matrix-name":"div","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"44","data-component-file":"StudentListModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex-1%20overflow-y-auto%20mt-6%20space-y-3%20pr-2%22%7D",children:o.map(A=>t.jsx(Ka,{student:A,onEdit:c,onDelete:f,"data-matrix-id":"src/components/StudentListModal.tsx:46:12","data-matrix-name":"StudentCard","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"46","data-component-file":"StudentListModal.tsx","data-component-name":"StudentCard","data-component-content":"%7B%22student%22%3A%22%5BIdentifier%5D%22%2C%22onEdit%22%3A%22%5BIdentifier%5D%22%2C%22onDelete%22%3A%22%5BIdentifier%5D%22%7D"},A.id))}),t.jsx("div",{className:"pt-6 border-t border-neutral-200 mt-6","data-matrix-id":"src/components/StudentListModal.tsx:56:8","data-matrix-name":"div","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"56","data-component-file":"StudentListModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22pt-6%20border-t%20border-neutral-200%20mt-6%22%7D",children:t.jsxs("button",{onClick:w,className:"w-full btn-primary flex items-center justify-center gap-2","data-matrix-id":"src/components/StudentListModal.tsx:57:10","data-matrix-name":"button","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"57","data-component-file":"StudentListModal.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22w-full%20btn-primary%20flex%20items-center%20justify-center%20gap-2%22%7D",children:[t.jsx(Ea,{className:"w-5 h-5","data-matrix-id":"src/components/StudentListModal.tsx:58:12","data-matrix-name":"Plus","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"58","data-component-file":"StudentListModal.tsx","data-component-name":"Plus","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"}),t.jsx("span",{"data-matrix-id":"src/components/StudentListModal.tsx:59:12","data-matrix-name":"span","data-component-path":"src/components/StudentListModal.tsx","data-component-line":"59","data-component-file":"StudentListModal.tsx","data-component-name":"span",children:"添加更多同学"})]})})]})}):null}function se({isOpen:a,onClose:n,mapElementId:o,studentCount:h,regionCount:c,mapsConfig:f,currentStudents:w=[],currentCountry:A="china"}){const[M,k]=s.useState("png"),[O,P]=s.useState(!1),U=Rt(),Z=async()=>{try{P(!0);const E=new Date().toISOString().split("T")[0],p=A==="china"?"中国":"美国",I=M==="png"?"png":"jpeg";let z=null;if(window.__mealMapExport)z=await window.__mealMapExport({format:M});else{const G=document.getElementById(o);if(!G)throw new Error(`Map element not found: ${o}`);let Y;window.__mealMapPrepareExport?Y=await window.__mealMapPrepareExport():window.__mealMapForceLineRecalc&&(await window.__mealMapForceLineRecalc(),await new Promise(et=>requestAnimationFrame(()=>requestAnimationFrame(et))));const ut=await ra(G,{backgroundColor:U.canvasBackgroundColor||"#f5f5f5",scale:window.devicePixelRatio*2,logging:!1,useCORS:!0,onclone:et=>{et.querySelectorAll("[data-export-ignore]").forEach(it=>it.remove())}}),L=M==="jpeg"?"image/jpeg":"image/png";z=ut.toDataURL(L),Y==null||Y()}if(!z)throw new Error("生成导出图片失败");const W=document.createElement("a");W.href=z,W.download=`${p}地图-${E}.${I}`,W.click(),n()}catch(E){console.error("Export failed:",E),alert(`导出失败: ${E instanceof Error?E.message:String(E)}`)}finally{P(!1)}};return a?t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50","data-matrix-id":"src/components/ExportModal.tsx:109:4","data-matrix-name":"div","data-component-path":"src/components/ExportModal.tsx","data-component-line":"109","data-component-file":"ExportModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22fixed%20inset-0%20bg-black%20bg-opacity-50%20flex%20items-center%20justify-center%20z-50%22%7D",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-96 max-w-90vw","data-matrix-id":"src/components/ExportModal.tsx:110:6","data-matrix-name":"div","data-component-path":"src/components/ExportModal.tsx","data-component-line":"110","data-component-file":"ExportModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22bg-white%20rounded-lg%20shadow-xl%20w-96%20max-w-90vw%22%7D",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b","data-matrix-id":"src/components/ExportModal.tsx:111:8","data-matrix-name":"div","data-component-path":"src/components/ExportModal.tsx","data-component-line":"111","data-component-file":"ExportModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20justify-between%20p-4%20border-b%22%7D",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900","data-matrix-id":"src/components/ExportModal.tsx:112:10","data-matrix-name":"h2","data-component-path":"src/components/ExportModal.tsx","data-component-line":"112","data-component-file":"ExportModal.tsx","data-component-name":"h2","data-component-content":"%7B%22className%22%3A%22text-lg%20font-semibold%20text-gray-900%22%7D",children:"导出地图"}),t.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",disabled:O,"data-matrix-id":"src/components/ExportModal.tsx:113:10","data-matrix-name":"button","data-component-path":"src/components/ExportModal.tsx","data-component-line":"113","data-component-file":"ExportModal.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22text-gray-400%20hover%3Atext-gray-600%22%2C%22disabled%22%3A%22%5BIdentifier%5D%22%7D",children:t.jsx(kt,{size:20,"data-matrix-id":"src/components/ExportModal.tsx:118:12","data-matrix-name":"X","data-component-path":"src/components/ExportModal.tsx","data-component-line":"118","data-component-file":"ExportModal.tsx","data-component-name":"X","data-component-content":"%7B%22size%22%3A20%7D"})})]}),t.jsxs("div",{className:"p-4 space-y-4","data-matrix-id":"src/components/ExportModal.tsx:122:8","data-matrix-name":"div","data-component-path":"src/components/ExportModal.tsx","data-component-line":"122","data-component-file":"ExportModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22p-4%20space-y-4%22%7D",children:[t.jsx("div",{className:"bg-gray-50 rounded-md p-3","data-matrix-id":"src/components/ExportModal.tsx:123:10","data-matrix-name":"div","data-component-path":"src/components/ExportModal.tsx","data-component-line":"123","data-component-file":"ExportModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22bg-gray-50%20rounded-md%20p-3%22%7D",children:t.jsxs("div",{className:"text-sm space-y-1","data-matrix-id":"src/components/ExportModal.tsx:124:12","data-matrix-name":"div","data-component-path":"src/components/ExportModal.tsx","data-component-line":"124","data-component-file":"ExportModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22text-sm%20space-y-1%22%7D",children:[t.jsxs("p",{"data-matrix-id":"src/components/ExportModal.tsx:125:14","data-matrix-name":"p","data-component-path":"src/components/ExportModal.tsx","data-component-line":"125","data-component-file":"ExportModal.tsx","data-component-name":"p",children:[t.jsx("span",{className:"font-medium","data-matrix-id":"src/components/ExportModal.tsx:126:16","data-matrix-name":"span","data-component-path":"src/components/ExportModal.tsx","data-component-line":"126","data-component-file":"ExportModal.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22font-medium%22%7D",children:"当前地图："}),A==="china"?"中国地图":"美国地图"]}),t.jsxs("p",{"data-matrix-id":"src/components/ExportModal.tsx:129:14","data-matrix-name":"p","data-component-path":"src/components/ExportModal.tsx","data-component-line":"129","data-component-file":"ExportModal.tsx","data-component-name":"p",children:[t.jsx("span",{className:"font-medium","data-matrix-id":"src/components/ExportModal.tsx:130:16","data-matrix-name":"span","data-component-path":"src/components/ExportModal.tsx","data-component-line":"130","data-component-file":"ExportModal.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22font-medium%22%7D",children:"已添加同学："}),h," 位"]}),t.jsxs("p",{"data-matrix-id":"src/components/ExportModal.tsx:133:14","data-matrix-name":"p","data-component-path":"src/components/ExportModal.tsx","data-component-line":"133","data-component-file":"ExportModal.tsx","data-component-name":"p",children:[t.jsx("span",{className:"font-medium","data-matrix-id":"src/components/ExportModal.tsx:134:16","data-matrix-name":"span","data-component-path":"src/components/ExportModal.tsx","data-component-line":"134","data-component-file":"ExportModal.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22font-medium%22%7D",children:"覆盖地区："}),c," 个"]})]})}),t.jsxs("div",{"data-matrix-id":"src/components/ExportModal.tsx:140:10","data-matrix-name":"div","data-component-path":"src/components/ExportModal.tsx","data-component-line":"140","data-component-file":"ExportModal.tsx","data-component-name":"div",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2","data-matrix-id":"src/components/ExportModal.tsx:141:12","data-matrix-name":"label","data-component-path":"src/components/ExportModal.tsx","data-component-line":"141","data-component-file":"ExportModal.tsx","data-component-name":"label","data-component-content":"%7B%22className%22%3A%22block%20text-sm%20font-medium%20text-gray-700%20mb-2%22%7D",children:"选择导出格式"}),t.jsxs("div",{className:"flex space-x-4","data-matrix-id":"src/components/ExportModal.tsx:144:12","data-matrix-name":"div","data-component-path":"src/components/ExportModal.tsx","data-component-line":"144","data-component-file":"ExportModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20space-x-4%22%7D",children:[t.jsxs("label",{className:"flex items-center","data-matrix-id":"src/components/ExportModal.tsx:145:14","data-matrix-name":"label","data-component-path":"src/components/ExportModal.tsx","data-component-line":"145","data-component-file":"ExportModal.tsx","data-component-name":"label","data-component-content":"%7B%22className%22%3A%22flex%20items-center%22%7D",children:[t.jsx("input",{type:"radio",value:"png",checked:M==="png",onChange:E=>k(E.target.value),className:"mr-2","data-matrix-id":"src/components/ExportModal.tsx:146:16","data-matrix-name":"input","data-component-path":"src/components/ExportModal.tsx","data-component-line":"146","data-component-file":"ExportModal.tsx","data-component-name":"input","data-component-content":"%7B%22type%22%3A%22radio%22%2C%22value%22%3A%22png%22%2C%22checked%22%3A%22%5BBinaryExpression%5D%22%2C%22onChange%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22mr-2%22%7D"}),"PNG (推荐)"]}),t.jsxs("label",{className:"flex items-center","data-matrix-id":"src/components/ExportModal.tsx:155:14","data-matrix-name":"label","data-component-path":"src/components/ExportModal.tsx","data-component-line":"155","data-component-file":"ExportModal.tsx","data-component-name":"label","data-component-content":"%7B%22className%22%3A%22flex%20items-center%22%7D",children:[t.jsx("input",{type:"radio",value:"jpeg",checked:M==="jpeg",onChange:E=>k(E.target.value),className:"mr-2","data-matrix-id":"src/components/ExportModal.tsx:156:16","data-matrix-name":"input","data-component-path":"src/components/ExportModal.tsx","data-component-line":"156","data-component-file":"ExportModal.tsx","data-component-name":"input","data-component-content":"%7B%22type%22%3A%22radio%22%2C%22value%22%3A%22jpeg%22%2C%22checked%22%3A%22%5BBinaryExpression%5D%22%2C%22onChange%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22mr-2%22%7D"}),"JPEG"]})]})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3","data-matrix-id":"src/components/ExportModal.tsx:168:10","data-matrix-name":"div","data-component-path":"src/components/ExportModal.tsx","data-component-line":"168","data-component-file":"ExportModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22bg-blue-50%20border%20border-blue-200%20rounded-md%20p-3%22%7D",children:t.jsxs("p",{className:"text-sm text-blue-800","data-matrix-id":"src/components/ExportModal.tsx:169:12","data-matrix-name":"p","data-component-path":"src/components/ExportModal.tsx","data-component-line":"169","data-component-file":"ExportModal.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22text-sm%20text-blue-800%22%7D",children:[t.jsx("strong",{"data-matrix-id":"src/components/ExportModal.tsx:170:14","data-matrix-name":"strong","data-component-path":"src/components/ExportModal.tsx","data-component-line":"170","data-component-file":"ExportModal.tsx","data-component-name":"strong",children:"导出说明："}),t.jsx("br",{"data-matrix-id":"src/components/ExportModal.tsx:171:14","data-matrix-name":"br","data-component-path":"src/components/ExportModal.tsx","data-component-line":"171","data-component-file":"ExportModal.tsx","data-component-name":"br"}),"• 导出将截取当前地图视图。",t.jsx("br",{"data-matrix-id":"src/components/ExportModal.tsx:173:14","data-matrix-name":"br","data-component-path":"src/components/ExportModal.tsx","data-component-line":"173","data-component-file":"ExportModal.tsx","data-component-name":"br"}),"• 学生信息将按所见显示。",t.jsx("br",{"data-matrix-id":"src/components/ExportModal.tsx:175:14","data-matrix-name":"br","data-component-path":"src/components/ExportModal.tsx","data-component-line":"175","data-component-file":"ExportModal.tsx","data-component-name":"br"}),"• 确保在导出前所有卡片都可见。"]})})]}),t.jsxs("div",{className:"flex space-x-3 p-4 border-t","data-matrix-id":"src/components/ExportModal.tsx:181:8","data-matrix-name":"div","data-component-path":"src/components/ExportModal.tsx","data-component-line":"181","data-component-file":"ExportModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20space-x-3%20p-4%20border-t%22%7D",children:[t.jsx("button",{onClick:n,className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:O,"data-matrix-id":"src/components/ExportModal.tsx:182:10","data-matrix-name":"button","data-component-path":"src/components/ExportModal.tsx","data-component-line":"182","data-component-file":"ExportModal.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22flex-1%20px-4%20py-2%20border%20border-gray-300%20rounded-md%20text-gray-700%20hover%3Abg-gray-50%22%2C%22disabled%22%3A%22%5BIdentifier%5D%22%7D",children:"取消"}),t.jsx("button",{onClick:Z,disabled:O,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center","data-matrix-id":"src/components/ExportModal.tsx:189:10","data-matrix-name":"button","data-component-path":"src/components/ExportModal.tsx","data-component-line":"189","data-component-file":"ExportModal.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22disabled%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22flex-1%20px-4%20py-2%20bg-blue-600%20text-white%20rounded-md%20hover%3Abg-blue-700%20disabled%3Aopacity-50%20flex%20items-center%20justify-center%22%7D",children:O?t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white","data-matrix-id":"src/components/ExportModal.tsx:195:14","data-matrix-name":"div","data-component-path":"src/components/ExportModal.tsx","data-component-line":"195","data-component-file":"ExportModal.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22animate-spin%20rounded-full%20h-4%20w-4%20border-b-2%20border-white%22%7D"}):t.jsxs(t.Fragment,{children:[t.jsx(zt,{size:16,className:"mr-2","data-matrix-id":"src/components/ExportModal.tsx:198:16","data-matrix-name":"Download","data-component-path":"src/components/ExportModal.tsx","data-component-line":"198","data-component-file":"ExportModal.tsx","data-component-name":"Download","data-component-content":"%7B%22size%22%3A16%2C%22className%22%3A%22mr-2%22%7D"}),"导出地图"]})})]})]})}):null}const re="#3b82f6";function ce({currentColor:a,onColorSelect:n,onReset:o,regionName:h}){const c=M=>M?M.startsWith("#")?M:Nt(M).hex:re,[f,w]=s.useState(c(a));s.useEffect(()=>{w(c(a))},[a]);const A=M=>{const k=M.target.value;w(k),n(k)};return t.jsxs("div",{className:"space-y-4","data-matrix-id":"src/components/ColorPicker.tsx:39:4","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"39","data-component-file":"ColorPicker.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22space-y-4%22%7D",children:[t.jsxs("div",{className:"flex items-center gap-2","data-matrix-id":"src/components/ColorPicker.tsx:40:6","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"40","data-component-file":"ColorPicker.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20gap-2%22%7D",children:[t.jsx(Et,{className:"w-5 h-5 text-primary-500","data-matrix-id":"src/components/ColorPicker.tsx:41:8","data-matrix-name":"Palette","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"41","data-component-file":"ColorPicker.tsx","data-component-name":"Palette","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%20text-primary-500%22%7D"}),t.jsx("h3",{className:"text-lg font-semibold text-neutral-900","data-matrix-id":"src/components/ColorPicker.tsx:42:8","data-matrix-name":"h3","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"42","data-component-file":"ColorPicker.tsx","data-component-name":"h3","data-component-content":"%7B%22className%22%3A%22text-lg%20font-semibold%20text-neutral-900%22%7D",children:h?`${h} 颜色设置`:"选择卡片颜色"})]}),t.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg p-4 border border-purple-200","data-matrix-id":"src/components/ColorPicker.tsx:47:6","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"47","data-component-file":"ColorPicker.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22bg-gradient-to-r%20from-purple-50%20to-pink-50%20rounded-lg%20p-4%20border%20border-purple-200%22%7D",children:[t.jsxs("button",{onClick:()=>{var M;return(M=document.getElementById("region-custom-color-input"))==null?void 0:M.click()},className:"flex items-center gap-3 text-left w-full mb-3","data-matrix-id":"src/components/ColorPicker.tsx:48:8","data-matrix-name":"button","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"48","data-component-file":"ColorPicker.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22flex%20items-center%20gap-3%20text-left%20w-full%20mb-3%22%7D",children:[t.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-white shadow-sm",style:{backgroundColor:Nt(a||f).hex},"data-matrix-id":"src/components/ColorPicker.tsx:52:10","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"52","data-component-file":"ColorPicker.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22w-8%20h-8%20rounded-full%20border-2%20border-white%20shadow-sm%22%2C%22style%22%3A%7B%22backgroundColor%22%3A%22%5BMemberExpression%5D%22%7D%7D"}),t.jsxs("div",{"data-matrix-id":"src/components/ColorPicker.tsx:56:10","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"56","data-component-file":"ColorPicker.tsx","data-component-name":"div",children:[t.jsx("p",{className:"text-sm font-medium text-purple-800","data-matrix-id":"src/components/ColorPicker.tsx:57:12","data-matrix-name":"p","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"57","data-component-file":"ColorPicker.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22text-sm%20font-medium%20text-purple-800%22%7D",children:"当前颜色"}),t.jsxs("p",{className:"text-xs text-purple-600","data-matrix-id":"src/components/ColorPicker.tsx:58:12","data-matrix-name":"p","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"58","data-component-file":"ColorPicker.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22text-xs%20text-purple-600%22%7D",children:[Nt(a||f).name||"自定义颜色"," · 点击修改"]})]})]}),t.jsxs("div",{className:"flex items-center gap-3","data-matrix-id":"src/components/ColorPicker.tsx:62:8","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"62","data-component-file":"ColorPicker.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20gap-3%22%7D",children:[t.jsx("input",{id:"region-custom-color-input",type:"color",value:f,onChange:A,className:"w-12 h-10 rounded border-2 border-white shadow-sm cursor-pointer",title:"选择自定义颜色","data-matrix-id":"src/components/ColorPicker.tsx:63:10","data-matrix-name":"input","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"63","data-component-file":"ColorPicker.tsx","data-component-name":"input","data-component-content":"%7B%22id%22%3A%22region-custom-color-input%22%2C%22type%22%3A%22color%22%2C%22value%22%3A%22%5BIdentifier%5D%22%2C%22onChange%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22w-12%20h-10%20rounded%20border-2%20border-white%20shadow-sm%20cursor-pointer%22%2C%22title%22%3A%22%E9%80%89%E6%8B%A9%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A2%9C%E8%89%B2%22%7D"}),t.jsxs("div",{className:"flex-1","data-matrix-id":"src/components/ColorPicker.tsx:71:10","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"71","data-component-file":"ColorPicker.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex-1%22%7D",children:[t.jsx("p",{className:"text-xs text-purple-700","data-matrix-id":"src/components/ColorPicker.tsx:72:12","data-matrix-name":"p","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"72","data-component-file":"ColorPicker.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22text-xs%20text-purple-700%22%7D",children:"通过颜色选择器选择任意颜色，自动应用"}),t.jsxs("p",{className:"text-xs text-purple-600 mt-1","data-matrix-id":"src/components/ColorPicker.tsx:75:12","data-matrix-name":"p","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"75","data-component-file":"ColorPicker.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22text-xs%20text-purple-600%20mt-1%22%7D",children:["当前：",f]})]})]})]}),t.jsxs("div",{"data-matrix-id":"src/components/ColorPicker.tsx:80:6","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"80","data-component-file":"ColorPicker.tsx","data-component-name":"div",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3","data-matrix-id":"src/components/ColorPicker.tsx:81:8","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"81","data-component-file":"ColorPicker.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20gap-2%20mb-3%22%7D",children:[t.jsx(Et,{className:"w-4 h-4 text-primary-500","data-matrix-id":"src/components/ColorPicker.tsx:82:10","data-matrix-name":"Palette","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"82","data-component-file":"ColorPicker.tsx","data-component-name":"Palette","data-component-content":"%7B%22className%22%3A%22w-4%20h-4%20text-primary-500%22%7D"}),t.jsx("span",{className:"text-sm font-medium text-neutral-700","data-matrix-id":"src/components/ColorPicker.tsx:83:10","data-matrix-name":"span","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"83","data-component-file":"ColorPicker.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22text-sm%20font-medium%20text-neutral-700%22%7D",children:"预设颜色"})]}),t.jsx("div",{className:"grid grid-cols-3 gap-3","data-matrix-id":"src/components/ColorPicker.tsx:86:8","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"86","data-component-file":"ColorPicker.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22grid%20grid-cols-3%20gap-3%22%7D",children:xt.map(M=>t.jsxs("button",{onClick:()=>n(M.value),className:`
                relative p-4 rounded-lg border-2 transition-all duration-200 hover:scale-105 hover:shadow-md
                ${a===M.value?"border-primary-500 ring-2 ring-primary-200":"border-neutral-200 hover:border-neutral-300"}
              `,title:M.name,"data-matrix-id":"src/components/ColorPicker.tsx:88:12","data-matrix-name":"button","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"88","data-component-file":"ColorPicker.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22%5BTemplateLiteral%5D%22%2C%22title%22%3A%22%5BMemberExpression%5D%22%7D",children:[t.jsxs("div",{className:"flex flex-col items-center gap-2","data-matrix-id":"src/components/ColorPicker.tsx:99:14","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"99","data-component-file":"ColorPicker.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20flex-col%20items-center%20gap-2%22%7D",children:[t.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-white shadow-sm",style:{backgroundColor:M.hex},"data-matrix-id":"src/components/ColorPicker.tsx:100:16","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"100","data-component-file":"ColorPicker.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22w-8%20h-8%20rounded-full%20border-2%20border-white%20shadow-sm%22%2C%22style%22%3A%7B%22backgroundColor%22%3A%22%5BMemberExpression%5D%22%7D%7D"}),t.jsx("span",{className:"text-xs font-medium text-neutral-700","data-matrix-id":"src/components/ColorPicker.tsx:104:16","data-matrix-name":"span","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"104","data-component-file":"ColorPicker.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22text-xs%20font-medium%20text-neutral-700%22%7D",children:M.name})]}),a===M.value&&t.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-primary-500 rounded-full flex items-center justify-center","data-matrix-id":"src/components/ColorPicker.tsx:107:16","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"107","data-component-file":"ColorPicker.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22absolute%20-top-1%20-right-1%20w-5%20h-5%20bg-primary-500%20rounded-full%20flex%20items-center%20justify-center%22%7D",children:t.jsx("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20","data-matrix-id":"src/components/ColorPicker.tsx:108:18","data-matrix-name":"svg","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"108","data-component-file":"ColorPicker.tsx","data-component-name":"svg","data-component-content":"%7B%22className%22%3A%22w-3%20h-3%20text-white%22%2C%22fill%22%3A%22currentColor%22%2C%22viewBox%22%3A%220%200%2020%2020%22%7D",children:t.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},M.value))})]}),o&&a&&t.jsxs("button",{onClick:o,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-neutral-100 hover:bg-neutral-200 text-neutral-700 rounded-lg transition-colors","data-matrix-id":"src/components/ColorPicker.tsx:123:8","data-matrix-name":"button","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"123","data-component-file":"ColorPicker.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22w-full%20flex%20items-center%20justify-center%20gap-2%20px-4%20py-2%20bg-neutral-100%20hover%3Abg-neutral-200%20text-neutral-700%20rounded-lg%20transition-colors%22%7D",children:[t.jsx(ja,{className:"w-4 h-4","data-matrix-id":"src/components/ColorPicker.tsx:127:10","data-matrix-name":"RotateCcw","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"127","data-component-file":"ColorPicker.tsx","data-component-name":"RotateCcw","data-component-content":"%7B%22className%22%3A%22w-4%20h-4%22%7D"}),"恢复默认颜色"]}),t.jsx("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200","data-matrix-id":"src/components/ColorPicker.tsx:132:6","data-matrix-name":"div","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"132","data-component-file":"ColorPicker.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22bg-blue-50%20rounded-lg%20p-3%20border%20border-blue-200%22%7D",children:t.jsx("p",{className:"text-sm text-blue-800","data-matrix-id":"src/components/ColorPicker.tsx:133:8","data-matrix-name":"p","data-component-path":"src/components/ColorPicker.tsx","data-component-line":"133","data-component-file":"ColorPicker.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22text-sm%20text-blue-800%22%7D",children:"💡 提示：选择预设或自定义颜色后立即生效。地图填充和卡片会一起更新。"})})]})}function ie({isOpen:a,onClose:n,onColorChanged:o,regions:h}){var E;const[c,f]=s.useState(null),[w,A]=s.useState({}),[M,k]=s.useState(Rt());s.useEffect(()=>{if(a){A(Wa());const p=Rt();k(p)}},[a]);const O=p=>{c&&($a(c,p),A(I=>({...I,[c]:p})),o==null||o())},P=()=>{c&&(za(c),A(p=>{const I={...p};return delete I[c],I}),o==null||o())},U=p=>w[p]||jt(p),Z=p=>Nt(p).hex;return a?t.jsx("div",{className:"modal-overlay",onClick:n,"data-matrix-id":"src/components/RegionColorManager.tsx:69:4","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"69","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22modal-overlay%22%2C%22onClick%22%3A%22%5BIdentifier%5D%22%7D",children:t.jsxs("div",{className:"modal-content max-w-4xl w-full mx-4 max-h-[90vh] flex flex-col",onClick:p=>p.stopPropagation(),"data-matrix-id":"src/components/RegionColorManager.tsx:70:6","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"70","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22modal-content%20max-w-4xl%20w-full%20mx-4%20max-h-%5B90vh%5D%20flex%20flex-col%22%2C%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%7D",children:[t.jsxs("div",{className:"flex items-center justify-between pb-6 border-b border-neutral-200","data-matrix-id":"src/components/RegionColorManager.tsx:74:8","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"74","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20justify-between%20pb-6%20border-b%20border-neutral-200%22%7D",children:[t.jsxs("div",{className:"flex items-center gap-3","data-matrix-id":"src/components/RegionColorManager.tsx:75:10","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"75","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20gap-3%22%7D",children:[t.jsx(Et,{className:"w-6 h-6 text-primary-500","data-matrix-id":"src/components/RegionColorManager.tsx:76:12","data-matrix-name":"Palette","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"76","data-component-file":"RegionColorManager.tsx","data-component-name":"Palette","data-component-content":"%7B%22className%22%3A%22w-6%20h-6%20text-primary-500%22%7D"}),t.jsx("h2",{className:"text-h2 font-semibold text-neutral-900","data-matrix-id":"src/components/RegionColorManager.tsx:77:12","data-matrix-name":"h2","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"77","data-component-file":"RegionColorManager.tsx","data-component-name":"h2","data-component-content":"%7B%22className%22%3A%22text-h2%20font-semibold%20text-neutral-900%22%7D",children:"颜色管理"})]}),t.jsx("button",{onClick:n,className:"btn-icon","data-matrix-id":"src/components/RegionColorManager.tsx:79:10","data-matrix-name":"button","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"79","data-component-file":"RegionColorManager.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BIdentifier%5D%22%2C%22className%22%3A%22btn-icon%22%7D",children:t.jsx(kt,{className:"w-5 h-5","data-matrix-id":"src/components/RegionColorManager.tsx:80:12","data-matrix-name":"X","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"80","data-component-file":"RegionColorManager.tsx","data-component-name":"X","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"})})]}),t.jsxs("div",{className:"mt-6 flex-1 overflow-y-auto pr-2","data-matrix-id":"src/components/RegionColorManager.tsx:84:8","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"84","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22mt-6%20flex-1%20overflow-y-auto%20pr-2%22%7D",children:[t.jsxs("div",{className:"flex gap-6 min-h-[360px]","data-matrix-id":"src/components/RegionColorManager.tsx:85:10","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"85","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20gap-6%20min-h-%5B360px%5D%22%7D",children:[t.jsxs("div",{className:"flex-1 overflow-y-auto","data-matrix-id":"src/components/RegionColorManager.tsx:86:12","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"86","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex-1%20overflow-y-auto%22%7D",children:[t.jsxs("h3",{className:"text-lg font-semibold text-neutral-900 mb-4 flex items-center gap-2","data-matrix-id":"src/components/RegionColorManager.tsx:87:14","data-matrix-name":"h3","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"87","data-component-file":"RegionColorManager.tsx","data-component-name":"h3","data-component-content":"%7B%22className%22%3A%22text-lg%20font-semibold%20text-neutral-900%20mb-4%20flex%20items-center%20gap-2%22%7D",children:[t.jsx(Ra,{className:"w-5 h-5","data-matrix-id":"src/components/RegionColorManager.tsx:88:16","data-matrix-name":"MapPin","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"88","data-component-file":"RegionColorManager.tsx","data-component-name":"MapPin","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%22%7D"}),"选择省份"]}),t.jsx("div",{className:"space-y-2","data-matrix-id":"src/components/RegionColorManager.tsx:92:12","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"92","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22space-y-2%22%7D",children:h.map(p=>{const I=U(p.id),z=w[p.id]!==void 0;return t.jsxs("button",{onClick:()=>f(p.id),className:`
                      w-full flex items-center gap-3 p-3 rounded-lg border-2 transition-all
                      ${c===p.id?"border-primary-500 bg-primary-50":"border-neutral-200 hover:border-neutral-300 hover:bg-neutral-50"}
                    `,"data-matrix-id":"src/components/RegionColorManager.tsx:97:18","data-matrix-name":"button","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"97","data-component-file":"RegionColorManager.tsx","data-component-name":"button","data-component-content":"%7B%22onClick%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22%5BTemplateLiteral%5D%22%7D",children:[t.jsx("div",{className:"w-6 h-6 rounded-full border-2 border-white shadow-sm flex-shrink-0",style:{backgroundColor:Z(I)},"data-matrix-id":"src/components/RegionColorManager.tsx:107:20","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"107","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22w-6%20h-6%20rounded-full%20border-2%20border-white%20shadow-sm%20flex-shrink-0%22%2C%22style%22%3A%7B%22backgroundColor%22%3A%22%5BCallExpression%5D%22%7D%7D"}),t.jsxs("div",{className:"flex-1 text-left","data-matrix-id":"src/components/RegionColorManager.tsx:111:20","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"111","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex-1%20text-left%22%7D",children:[t.jsx("div",{className:"font-medium text-neutral-900","data-matrix-id":"src/components/RegionColorManager.tsx:112:22","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"112","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22font-medium%20text-neutral-900%22%7D",children:p.name}),t.jsx("div",{className:"text-sm text-neutral-500","data-matrix-id":"src/components/RegionColorManager.tsx:113:22","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"113","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22text-sm%20text-neutral-500%22%7D",children:p.country==="china"?"🇨🇳 中国":"🇺🇸 美国"})]}),t.jsx("div",{className:"text-right text-xs text-neutral-500","data-matrix-id":"src/components/RegionColorManager.tsx:117:20","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"117","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22text-right%20text-xs%20text-neutral-500%22%7D",children:z?"已自定义":"默认"})]},p.id)})})]}),t.jsx("div",{className:"w-80 border-l border-neutral-200 pl-6 h-full overflow-y-auto","data-matrix-id":"src/components/RegionColorManager.tsx:126:12","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"126","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22w-80%20border-l%20border-neutral-200%20pl-6%20h-full%20overflow-y-auto%22%7D",children:c?t.jsx(ce,{currentColor:U(c),onColorSelect:O,onReset:w[c]?P:void 0,regionName:(E=h.find(p=>p.id===c))==null?void 0:E.name,"data-matrix-id":"src/components/RegionColorManager.tsx:128:16","data-matrix-name":"ColorPicker","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"128","data-component-file":"RegionColorManager.tsx","data-component-name":"ColorPicker","data-component-content":"%7B%22currentColor%22%3A%22%5BCallExpression%5D%22%2C%22onColorSelect%22%3A%22%5BIdentifier%5D%22%2C%22onReset%22%3A%22%5BConditionalExpression%5D%22%2C%22regionName%22%3A%22%5BOptionalMemberExpression%5D%22%7D"}):t.jsx("div",{className:"flex items-center justify-center h-full text-neutral-500","data-matrix-id":"src/components/RegionColorManager.tsx:135:16","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"135","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20justify-center%20h-full%20text-neutral-500%22%7D",children:t.jsxs("div",{className:"text-center","data-matrix-id":"src/components/RegionColorManager.tsx:136:18","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"136","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22text-center%22%7D",children:[t.jsx(Et,{className:"w-12 h-12 mx-auto mb-3 text-neutral-300","data-matrix-id":"src/components/RegionColorManager.tsx:137:20","data-matrix-name":"Palette","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"137","data-component-file":"RegionColorManager.tsx","data-component-name":"Palette","data-component-content":"%7B%22className%22%3A%22w-12%20h-12%20mx-auto%20mb-3%20text-neutral-300%22%7D"}),t.jsx("p",{"data-matrix-id":"src/components/RegionColorManager.tsx:138:20","data-matrix-name":"p","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"138","data-component-file":"RegionColorManager.tsx","data-component-name":"p",children:"请选择左侧省份"}),t.jsx("p",{className:"text-sm","data-matrix-id":"src/components/RegionColorManager.tsx:139:20","data-matrix-name":"p","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"139","data-component-file":"RegionColorManager.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22text-sm%22%7D",children:"来设置自定义颜色"})]})})})]}),t.jsxs("div",{className:"mt-6 grid gap-4 md:grid-cols-2","data-matrix-id":"src/components/RegionColorManager.tsx:146:10","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"146","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22mt-6%20grid%20gap-4%20md%3Agrid-cols-2%22%7D",children:[t.jsxs("div",{className:"bg-white rounded-lg border border-neutral-200 p-4","data-matrix-id":"src/components/RegionColorManager.tsx:147:12","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"147","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22bg-white%20rounded-lg%20border%20border-neutral-200%20p-4%22%7D",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3","data-matrix-id":"src/components/RegionColorManager.tsx:148:14","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"148","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20gap-2%20mb-3%22%7D",children:[t.jsx(ka,{className:"w-4 h-4 text-primary-500","data-matrix-id":"src/components/RegionColorManager.tsx:149:16","data-matrix-name":"SlidersHorizontal","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"149","data-component-file":"RegionColorManager.tsx","data-component-name":"SlidersHorizontal","data-component-content":"%7B%22className%22%3A%22w-4%20h-4%20text-primary-500%22%7D"}),t.jsx("h4",{className:"font-medium text-neutral-900","data-matrix-id":"src/components/RegionColorManager.tsx:150:16","data-matrix-name":"h4","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"150","data-component-file":"RegionColorManager.tsx","data-component-name":"h4","data-component-content":"%7B%22className%22%3A%22font-medium%20text-neutral-900%22%7D",children:"基础地图颜色"})]}),t.jsxs("div",{className:"space-y-4","data-matrix-id":"src/components/RegionColorManager.tsx:152:14","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"152","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22space-y-4%22%7D",children:[t.jsxs("label",{className:"flex items-center justify-between gap-2 text-sm","data-matrix-id":"src/components/RegionColorManager.tsx:153:16","data-matrix-name":"label","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"153","data-component-file":"RegionColorManager.tsx","data-component-name":"label","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20justify-between%20gap-2%20text-sm%22%7D",children:[t.jsx("span",{className:"text-neutral-600","data-matrix-id":"src/components/RegionColorManager.tsx:154:18","data-matrix-name":"span","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"154","data-component-file":"RegionColorManager.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22text-neutral-600%22%7D",children:"无同学地区填充色"}),t.jsx("input",{type:"color",value:M.emptyRegionColor,onChange:p=>{const I=sa({emptyRegionColor:p.target.value});k(I),o==null||o()},className:"w-12 h-8 rounded border border-neutral-200 cursor-pointer","data-matrix-id":"src/components/RegionColorManager.tsx:155:18","data-matrix-name":"input","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"155","data-component-file":"RegionColorManager.tsx","data-component-name":"input","data-component-content":"%7B%22type%22%3A%22color%22%2C%22value%22%3A%22%5BMemberExpression%5D%22%2C%22onChange%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22w-12%20h-8%20rounded%20border%20border-neutral-200%20cursor-pointer%22%7D"})]}),t.jsxs("label",{className:"flex items-center justify-between gap-2 text-sm","data-matrix-id":"src/components/RegionColorManager.tsx:166:16","data-matrix-name":"label","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"166","data-component-file":"RegionColorManager.tsx","data-component-name":"label","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20justify-between%20gap-2%20text-sm%22%7D",children:[t.jsx("span",{className:"text-neutral-600","data-matrix-id":"src/components/RegionColorManager.tsx:167:18","data-matrix-name":"span","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"167","data-component-file":"RegionColorManager.tsx","data-component-name":"span","data-component-content":"%7B%22className%22%3A%22text-neutral-600%22%7D",children:"画布背景色"}),t.jsx("input",{type:"color",value:M.canvasBackgroundColor,onChange:p=>{const I=sa({canvasBackgroundColor:p.target.value});k(I),o==null||o()},className:"w-12 h-8 rounded border border-neutral-200 cursor-pointer","data-matrix-id":"src/components/RegionColorManager.tsx:168:18","data-matrix-name":"input","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"168","data-component-file":"RegionColorManager.tsx","data-component-name":"input","data-component-content":"%7B%22type%22%3A%22color%22%2C%22value%22%3A%22%5BMemberExpression%5D%22%2C%22onChange%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22className%22%3A%22w-12%20h-8%20rounded%20border%20border-neutral-200%20cursor-pointer%22%7D"})]})]})]}),t.jsxs("div",{className:"bg-amber-50 rounded-lg p-4 border border-amber-200","data-matrix-id":"src/components/RegionColorManager.tsx:182:12","data-matrix-name":"div","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"182","data-component-file":"RegionColorManager.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22bg-amber-50%20rounded-lg%20p-4%20border%20border-amber-200%22%7D",children:[t.jsx("h4",{className:"font-medium text-amber-900 mb-2","data-matrix-id":"src/components/RegionColorManager.tsx:183:14","data-matrix-name":"h4","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"183","data-component-file":"RegionColorManager.tsx","data-component-name":"h4","data-component-content":"%7B%22className%22%3A%22font-medium%20text-amber-900%20mb-2%22%7D",children:"💡 使用说明"}),t.jsxs("ul",{className:"text-sm text-amber-800 space-y-1","data-matrix-id":"src/components/RegionColorManager.tsx:184:14","data-matrix-name":"ul","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"184","data-component-file":"RegionColorManager.tsx","data-component-name":"ul","data-component-content":"%7B%22className%22%3A%22text-sm%20text-amber-800%20space-y-1%22%7D",children:[t.jsx("li",{"data-matrix-id":"src/components/RegionColorManager.tsx:185:16","data-matrix-name":"li","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"185","data-component-file":"RegionColorManager.tsx","data-component-name":"li",children:"• 仅显示当前地图中有同学的省份/州"}),t.jsx("li",{"data-matrix-id":"src/components/RegionColorManager.tsx:186:16","data-matrix-name":"li","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"186","data-component-file":"RegionColorManager.tsx","data-component-name":"li",children:"• 点击“当前颜色”或预设色块即可实时应用"}),t.jsx("li",{"data-matrix-id":"src/components/RegionColorManager.tsx:187:16","data-matrix-name":"li","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"187","data-component-file":"RegionColorManager.tsx","data-component-name":"li",children:"• 下方输入框可直接调整基础地图填充与背景色"}),t.jsx("li",{"data-matrix-id":"src/components/RegionColorManager.tsx:188:16","data-matrix-name":"li","data-component-path":"src/components/RegionColorManager.tsx","data-component-line":"188","data-component-file":"RegionColorManager.tsx","data-component-name":"li",children:"• 所有设置都会保存在本地，刷新后依然生效"})]})]})]})]})]})}):null}function de(){const[a,n]=s.useState("china"),[o,h]=s.useState([]),[c,f]=s.useState(null),[w,A]=s.useState(!0),[M,k]=s.useState(!1),[O,P]=s.useState(!1),[U,Z]=s.useState(!1),[E,p]=s.useState(!1),[I,z]=s.useState(null),[W,G]=s.useState(null),[Y,ut]=s.useState([]),[L,et]=s.useState(0);s.useEffect(()=>{fetch("/MealMap/data/maps-config.json").then(j=>j.json()).then(j=>{f(j),A(!1)}).catch(j=>{console.error("Failed to load map configuration:",j),A(!1)})},[]),s.useEffect(()=>{it()},[]);const it=()=>{const B=Ht();h(B)},rt=B=>{z(B),G(null),k(!0)},V=B=>{const j=pt().find(Ct=>Ct.id===B.region_id);j&&(z(j),G(B),k(!0))},yt=async B=>{try{W?Ua(W.id,B):qa({country:B.country,region_id:B.region_id,region_name:B.region_name,name:B.name,city:B.city,color:B.color}),it(),k(!1)}catch(j){throw console.error("Failed to save student:",j),j}},ht=async B=>{try{if(!Ga(B)){console.error("Delete failed: student not found"),alert("删除失败，请重试");return}it()}catch(j){console.error("Failed to delete student:",j),alert("删除失败，请重试")}},lt=(B,j)=>{z(B),ut(j),P(!0)},Q=()=>{et(B=>B+1),it()},pt=()=>c?c.countries[a].administrative_divisions:[],nt=()=>o.filter(B=>B.country===a),wt=()=>new Set(nt().map(j=>j.region_id)).size;if(w)return t.jsx("div",{className:"flex items-center justify-center min-h-screen bg-surface-base","data-matrix-id":"src/App.tsx:142:6","data-matrix-name":"div","data-component-path":"src/App.tsx","data-component-line":"142","data-component-file":"App.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20justify-center%20min-h-screen%20bg-surface-base%22%7D",children:t.jsxs("div",{className:"text-center","data-matrix-id":"src/App.tsx:143:8","data-matrix-name":"div","data-component-path":"src/App.tsx","data-component-line":"143","data-component-file":"App.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22text-center%22%7D",children:[t.jsx("div",{className:"inline-block w-12 h-12 border-4 border-primary-500 border-t-transparent rounded-full animate-spin","data-matrix-id":"src/App.tsx:144:10","data-matrix-name":"div","data-component-path":"src/App.tsx","data-component-line":"144","data-component-file":"App.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22inline-block%20w-12%20h-12%20border-4%20border-primary-500%20border-t-transparent%20rounded-full%20animate-spin%22%7D"}),t.jsx("p",{className:"mt-4 text-body text-neutral-700","data-matrix-id":"src/App.tsx:145:10","data-matrix-name":"p","data-component-path":"src/App.tsx","data-component-line":"145","data-component-file":"App.tsx","data-component-name":"p","data-component-content":"%7B%22className%22%3A%22mt-4%20text-body%20text-neutral-700%22%7D",children:"加载中..."})]})});const vt=c?c.countries[a].administrative_divisions.filter(B=>o.some(j=>j.country===a&&j.region_id===B.id)).map(B=>({...B,country:a})):[];return t.jsxs("div",{className:"min-h-screen bg-surface-base","data-matrix-id":"src/App.tsx:160:4","data-matrix-name":"div","data-component-path":"src/App.tsx","data-component-line":"160","data-component-file":"App.tsx","data-component-name":"div","data-component-content":"%7B%22className%22%3A%22min-h-screen%20bg-surface-base%22%7D",children:[t.jsx(Pa,{"data-matrix-id":"src/App.tsx:161:6","data-matrix-name":"Analytics","data-component-path":"src/App.tsx","data-component-line":"161","data-component-file":"App.tsx","data-component-name":"Analytics"}),t.jsx(Ia,{"data-matrix-id":"src/App.tsx:162:6","data-matrix-name":"SpeedInsights","data-component-path":"src/App.tsx","data-component-line":"162","data-component-file":"App.tsx","data-component-name":"SpeedInsights"}),t.jsx(Va,{selectedCountry:a,onCountryChange:n,studentCount:nt().length,onExport:()=>Z(!0),onColorManager:()=>p(!0),"data-matrix-id":"src/App.tsx:164:6","data-matrix-name":"Navigation","data-component-path":"src/App.tsx","data-component-line":"164","data-component-file":"App.tsx","data-component-name":"Navigation","data-component-content":"%7B%22selectedCountry%22%3A%22%5BIdentifier%5D%22%2C%22onCountryChange%22%3A%22%5BIdentifier%5D%22%2C%22studentCount%22%3A%22%5BMemberExpression%5D%22%2C%22onExport%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22onColorManager%22%3A%22%5BArrowFunctionExpression%5D%22%7D"}),t.jsx("main",{className:"pt-16 md:pt-18","data-matrix-id":"src/App.tsx:173:6","data-matrix-name":"main","data-component-path":"src/App.tsx","data-component-line":"173","data-component-file":"App.tsx","data-component-name":"main","data-component-content":"%7B%22className%22%3A%22pt-16%20md%3Apt-18%22%7D",children:t.jsx("div",{id:"map-container","data-country":a,className:"w-full",style:{height:"calc(100vh - 4rem)"},"data-matrix-id":"src/App.tsx:174:8","data-matrix-name":"div","data-component-path":"src/App.tsx","data-component-line":"174","data-component-file":"App.tsx","data-component-name":"div","data-component-content":"%7B%22id%22%3A%22map-container%22%2C%22className%22%3A%22w-full%22%2C%22style%22%3A%7B%22height%22%3A%22calc(100vh%20-%204rem)%22%7D%7D",children:!w&&c&&t.jsx(ee,{country:a,regions:pt(),students:nt(),onRegionClick:rt,onStudentEdit:V,onStudentDelete:ht,onShowList:lt,colorChanged:L,"data-matrix-id":"src/App.tsx:181:12","data-matrix-name":"InteractiveMap","data-component-path":"src/App.tsx","data-component-line":"181","data-component-file":"App.tsx","data-component-name":"InteractiveMap","data-component-content":"%7B%22country%22%3A%22%5BIdentifier%5D%22%2C%22regions%22%3A%22%5BCallExpression%5D%22%2C%22students%22%3A%22%5BCallExpression%5D%22%2C%22onRegionClick%22%3A%22%5BIdentifier%5D%22%2C%22onStudentEdit%22%3A%22%5BIdentifier%5D%22%2C%22onStudentDelete%22%3A%22%5BIdentifier%5D%22%2C%22onShowList%22%3A%22%5BIdentifier%5D%22%2C%22colorChanged%22%3A%22%5BIdentifier%5D%22%7D"})})}),I&&t.jsxs(t.Fragment,{children:[t.jsx(ne,{isOpen:M,onClose:()=>{k(!1),G(null)},onSave:yt,student:W,regionName:I.name,regionId:I.id,country:a,"data-matrix-id":"src/App.tsx:198:10","data-matrix-name":"StudentModal","data-component-path":"src/App.tsx","data-component-line":"198","data-component-file":"App.tsx","data-component-name":"StudentModal","data-component-content":"%7B%22isOpen%22%3A%22%5BIdentifier%5D%22%2C%22onClose%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22onSave%22%3A%22%5BIdentifier%5D%22%2C%22student%22%3A%22%5BIdentifier%5D%22%2C%22regionName%22%3A%22%5BMemberExpression%5D%22%2C%22regionId%22%3A%22%5BMemberExpression%5D%22%2C%22country%22%3A%22%5BIdentifier%5D%22%7D"}),t.jsx(oe,{isOpen:O,onClose:()=>P(!1),students:Y,regionName:I.name,onEdit:V,onDelete:ht,onAddNew:()=>{P(!1),G(null),k(!0)},"data-matrix-id":"src/App.tsx:211:10","data-matrix-name":"StudentListModal","data-component-path":"src/App.tsx","data-component-line":"211","data-component-file":"App.tsx","data-component-name":"StudentListModal","data-component-content":"%7B%22isOpen%22%3A%22%5BIdentifier%5D%22%2C%22onClose%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22students%22%3A%22%5BIdentifier%5D%22%2C%22regionName%22%3A%22%5BMemberExpression%5D%22%2C%22onEdit%22%3A%22%5BIdentifier%5D%22%2C%22onDelete%22%3A%22%5BIdentifier%5D%22%2C%22onAddNew%22%3A%22%5BArrowFunctionExpression%5D%22%7D"})]}),t.jsx(se,{isOpen:U,onClose:()=>Z(!1),mapElementId:"map-container",studentCount:nt().length,regionCount:wt(),mapsConfig:c,currentStudents:nt(),currentCountry:a,"data-matrix-id":"src/App.tsx:227:6","data-matrix-name":"ExportModal","data-component-path":"src/App.tsx","data-component-line":"227","data-component-file":"App.tsx","data-component-name":"ExportModal","data-component-content":"%7B%22isOpen%22%3A%22%5BIdentifier%5D%22%2C%22onClose%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22mapElementId%22%3A%22map-container%22%2C%22studentCount%22%3A%22%5BMemberExpression%5D%22%2C%22regionCount%22%3A%22%5BCallExpression%5D%22%2C%22mapsConfig%22%3A%22%5BIdentifier%5D%22%2C%22currentStudents%22%3A%22%5BCallExpression%5D%22%2C%22currentCountry%22%3A%22%5BIdentifier%5D%22%7D"}),c&&t.jsx(ie,{isOpen:E,onClose:()=>p(!1),onColorChanged:Q,regions:vt,"data-matrix-id":"src/App.tsx:240:8","data-matrix-name":"RegionColorManager","data-component-path":"src/App.tsx","data-component-line":"240","data-component-file":"App.tsx","data-component-name":"RegionColorManager","data-component-content":"%7B%22isOpen%22%3A%22%5BIdentifier%5D%22%2C%22onClose%22%3A%22%5BArrowFunctionExpression%5D%22%2C%22onColorChanged%22%3A%22%5BIdentifier%5D%22%2C%22regions%22%3A%22%5BIdentifier%5D%22%7D"})]})}La.createRoot(document.getElementById("root")).render(t.jsx(s.StrictMode,{"data-matrix-id":"src/main.tsx:8:2","data-matrix-name":"StrictMode","data-component-path":"src/main.tsx","data-component-line":"8","data-component-file":"main.tsx","data-component-name":"StrictMode",children:t.jsx(Ta,{children:t.jsx(de,{"data-matrix-id":"src/main.tsx:10:6","data-matrix-name":"App","data-component-path":"src/main.tsx","data-component-line":"10","data-component-file":"main.tsx","data-component-name":"App"})})}));
